import{a as tt}from"./chunk-QEL4QHDB.js";import"./chunk-MWHTB2V2.js";import{a as Y,c as q}from"./chunk-IPUDXWEC.js";import"./chunk-YQDFRMJL.js";import"./chunk-T47TWMLD.js";import{E as I,S as Z,a as b,i as J,n as X}from"./chunk-6KTUUYWT.js";import{$ as e,Aa as h,Ba as g,Ca as C,Ja as O,Jb as B,Kb as z,La as k,Lb as L,Mb as A,Na as D,Nb as j,Oa as T,Pb as F,Q as a,R as x,Rb as G,T as E,Ub as N,X as f,Z as l,_a as $,aa as i,ba as m,bc as V,fc as H,ha as P,ia as _,kc as Q,lc as R,ra as c,ta as v,tc as K,vc as U,xc as W,za as S}from"./chunk-FQHFODV6.js";import"./chunk-GRX4ZZSO.js";import"./chunk-7KGURMOZ.js";import"./chunk-Y2YV2HED.js";import"./chunk-EDCKRRWH.js";import"./chunk-SPCCATGZ.js";import"./chunk-YKMIF4NY.js";import"./chunk-YVBCZ55L.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-D5MTWDX2.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{i as w}from"./chunk-OYAVQN5W.js";var et=()=>["list"];function nt(r,d){if(r&1&&(e(0,"div",10)(1,"div",11)(2,"div",12),m(3,"ion-icon",13),i(),e(4,"div",14),c(5,"Total Earnings"),i(),e(6,"div",15),c(7),h(8,"async"),h(9,"number"),i(),e(10,"div",16),c(11),h(12,"async"),i(),e(13,"div",17),m(14,"ion-icon",18),e(15,"small"),c(16,"View All"),i()()(),e(17,"div",19)(18,"div",20),m(19,"ion-icon",21),i(),e(20,"div",14),c(21,"This Month"),i(),e(22,"div",15),c(23),h(24,"number"),i(),e(25,"div",16),c(26),i()()()),r&2){let u,t,n=_();a(),l("routerLink",S(15,et)),a(6),v("\u20B9",C(9,7,((u=g(8,5,n.summary$))==null?null:u.totalAmount)||0,"1.0-0"),""),a(4),v("",((t=g(12,10,n.summary$))==null?null:t.totalPayments)||0," total payments"),a(12),v("\u20B9",C(24,12,n.currentMonthEarnings,"1.0-0"),""),a(3),v("",n.currentMonthPayments," payments this month")}}function it(r,d){if(r&1&&(e(0,"ion-card",22)(1,"ion-card-header")(2,"ion-card-title"),c(3,"Monthly Earnings"),i()(),e(4,"ion-card-content")(5,"div",23),m(6,"google-chart",24),i()()()),r&2){let u=_();a(6),l("type",u.chartType)("data",u.chartData)("columns",u.chartColumns)("options",u.chartOptions)("height",300)}}function ot(r,d){r&1&&(e(0,"div",25)(1,"ion-card")(2,"ion-card-header")(3,"ion-card-title"),m(4,"ion-skeleton-text",26),i()(),e(5,"ion-card-content"),m(6,"ion-skeleton-text",27)(7,"ion-skeleton-text",28),i()()()),r&2&&(a(4),l("animated",!0),a(2),l("animated",!0),a(),l("animated",!0))}function at(r,d){r&1&&(e(0,"ion-card",29)(1,"ion-card-content")(2,"div",30),m(3,"ion-icon",31),e(4,"div",32)(5,"h3"),c(6,"View All Payments"),i(),e(7,"p"),c(8,"See detailed payment history"),i()(),m(9,"ion-icon",33),i()()()),r&2&&l("routerLink",S(1,et))}b({refresh:I,wallet:Z,calendar:J,chevronForwardOutline:X});var yt=(()=>{let d=class d{constructor(t,n){this.paymentService=t,this.toastController=n,this.loading$=this.paymentService.loading$,this.summary$=this.paymentService.summary$,this.displayedGroups=[],this.searchQuery="",this.chartType=Y.LineChart,this.chartColumns=["Month","Amount",{type:"string",role:"tooltip"}],this.chartData=[],this.chartOptions={backgroundColor:"transparent",colors:["#2dd36f"],chartArea:{left:60,top:20,width:"85%",height:"75%"},hAxis:{textStyle:{fontSize:12,color:"#666"},gridlines:{color:"transparent"}},vAxis:{textStyle:{fontSize:12,color:"#666"},gridlines:{color:"#e0e0e0",count:5},minValue:0},legend:{position:"none"},animation:{startup:!0,duration:1e3,easing:"out"},pointSize:5,lineWidth:2},this.currentMonthEarnings=0,this.currentMonthPayments=0,this.refreshing=!1,b({refresh:I})}prepareChartData(t){if(!t){this.chartData=[];return}let n=Object.entries(t.monthBreakdown).map(([o,s])=>({month:o,amount:s.amount,count:s.count})).sort((o,s)=>o.month.localeCompare(s.month));this.chartData=n.map(o=>{let p=new Date(o.month+"-01").toLocaleString("default",{month:"short",year:"2-digit"});return[p,o.amount,`${p}
Amount: \u20B9${o.amount}
Payments: ${o.count}`]})}ngOnInit(){this.paymentService.payments$.subscribe(t=>{t&&this.processPayments(t)}),this.summary$.subscribe(t=>{this.prepareChartData(t)}),this.paymentService.loadData().catch(t=>{console.error("Error initializing payments:",t)})}processPayments(t){let n=new Map,o=new Date().toISOString().substring(0,7);this.currentMonthEarnings=0,this.currentMonthPayments=0,t.forEach(s=>{let p=new Date(s.date),y=p.toISOString().substring(0,7);y===o&&(this.currentMonthEarnings+=s.amount,this.currentMonthPayments++),n.has(y)||n.set(y,{month:y,formattedDate:p.toLocaleDateString("en-US",{month:"long",year:"numeric"}),payments:[],total:0});let M=n.get(y);M.payments.push(s),M.total+=s.amount}),this.displayedGroups=Array.from(n.values()).sort((s,p)=>p.month.localeCompare(s.month))}refreshPayments(){return w(this,null,function*(){if(!this.refreshing)try{this.refreshing=!0,console.log("Refreshing payment data..."),yield this.paymentService.loadData(),console.log("Payment data refreshed successfully"),yield(yield this.toastController.create({message:"Payment data refreshed successfully",duration:2e3,color:"success"})).present()}catch(t){console.error("Error refreshing payment data:",t),yield(yield this.toastController.create({message:"Failed to refresh payment data",duration:2e3,color:"danger"})).present()}finally{this.refreshing=!1}})}onSearchChange(t){var n;this.searchQuery=((n=t.detail.value)==null?void 0:n.toLowerCase())||""}showPaymentDetails(t){console.log("Show payment details:",t)}goToPaymentsList(){console.log("Navigating to payments list...")}};d.\u0275fac=function(n){return new(n||d)(x(tt),x(K))},d.\u0275cmp=E({type:d,selectors:[["app-payments"]],decls:20,vars:14,consts:[["color","primary"],["slot","start"],["slot","end"],[3,"click","disabled"],["slot","icon-only","name","refresh"],["placeholder","Search payments",3,"ionInput","debounce"],["class","stats-grid",4,"ngIf"],["class","chart-card",4,"ngIf"],["class","ion-padding",4,"ngIf"],["class","action-card",3,"routerLink",4,"ngIf"],[1,"stats-grid"],[1,"stat-card",3,"routerLink"],[1,"stat-icon","total-earnings"],["name","wallet"],[1,"stat-label"],[1,"stat-value"],[1,"stat-subtext"],[1,"view-details"],["name","chevron-forward-outline","size","small"],[1,"stat-card"],[1,"stat-icon","monthly-earnings"],["name","calendar"],[1,"chart-card"],[2,"display","flex","justify-content","center","align-items","center"],[3,"type","data","columns","options","height"],[1,"ion-padding"],[2,"width","60%",3,"animated"],[2,"width","100%",3,"animated"],[2,"width","80%",3,"animated"],[1,"action-card",3,"routerLink"],[1,"action-content"],["name","list-outline","color","primary"],[1,"action-text"],["name","chevron-forward-outline","color","medium"]],template:function(n,o){n&1&&(e(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),m(3,"ion-menu-button"),i(),e(4,"ion-title"),c(5,"Payments"),i(),e(6,"ion-buttons",2)(7,"ion-button",3),P("click",function(){return o.refreshPayments()}),m(8,"ion-icon",4),i()()(),e(9,"ion-toolbar")(10,"ion-searchbar",5),P("ionInput",function(p){return o.onSearchChange(p)}),i()()(),e(11,"ion-content"),f(12,nt,27,16,"div",6),h(13,"async"),f(14,it,7,5,"ion-card",7),h(15,"async"),f(16,ot,8,3,"div",8),h(17,"async"),f(18,at,10,2,"ion-card",9),h(19,"async"),i()),n&2&&(a(7),l("disabled",o.refreshing),a(3),l("debounce",500),a(2),l("ngIf",!g(13,6,o.loading$)),a(2),l("ngIf",!g(15,8,o.loading$)&&o.chartData.length>0),a(2),l("ngIf",g(17,10,o.loading$)),a(2),l("ngIf",!g(19,12,o.loading$)))},dependencies:[T,O,k,D,$,N,R,Q,G,L,j,A,F,W,z,V,H,B,U,q],styles:[".stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px;padding:12px}.stat-card[_ngcontent-%COMP%]{background-color:var(--ion-card-background);border-radius:12px;padding:16px;display:flex;flex-direction:column;align-items:flex-start;position:relative;box-shadow:var(--ion-card-box-shadow);transition:transform .2s ease}.stat-card[routerLink][_ngcontent-%COMP%]{cursor:pointer}.stat-card[routerLink][_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.stat-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin-bottom:12px}.stat-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:#fff}.stat-icon.total-earnings[_ngcontent-%COMP%]{background-color:var(--ion-color-primary)}.stat-icon.monthly-earnings[_ngcontent-%COMP%]{background-color:var(--ion-color-success)}.stat-label[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:.9rem;font-weight:500;margin-bottom:4px}.stat-value[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;color:var(--ion-color-dark);margin-bottom:4px}.stat-subtext[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:.85rem}.view-details[_ngcontent-%COMP%]{position:absolute;bottom:12px;right:12px;display:flex;align-items:center;gap:4px;color:var(--ion-color-primary);font-size:.8rem}.view-details[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem}.chart-card[_ngcontent-%COMP%]{margin:12px}.amount-note[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem}.status-badge[_ngcontent-%COMP%]{margin-left:8px;text-transform:capitalize}"]});let r=d;return r})();export{yt as PaymentsPage};
