import{a as vt,c as It}from"./chunk-UQZAST5U.js";import{a as jt}from"./chunk-6WPVMACQ.js";import{a as Ct,b as St,c as F,d as _t,e as l}from"./chunk-SQ4AFRWT.js";import{C as $,D as gt,F as ht,G as k,K as xt,X as yt,a as at,b as pt,c as ct,ca as bt,d as mt,e as lt,q as ut,r as ft,s as dt}from"./chunk-QUCUL4SD.js";import{$ as Q,A as G,Ba as P,Ca as A,Ea as Z,Ha as T,I as J,Ia as tt,J as u,Ja as et,K as p,Ka as it,La as ot,M as _,Ma as R,N as K,Na as I,Oa as rt,Pa as nt,Q as h,Qa as st,T as f,V as a,W as d,X as v,Xb as E,aa as x,ba as y,e as N,g as B,ja as b,ka as L,l as z,n as V,qa as X,r as g,ra as j,s as q,sa as w,ta as Y,u as n,x as U,z as W,za as M}from"./chunk-ZFR4GTBG.js";import"./chunk-AW5PRJD7.js";import"./chunk-T47TWMLD.js";import"./chunk-X2LLLM27.js";import"./chunk-GDTBDVVA.js";import"./chunk-EYVCEYVV.js";import"./chunk-YKMIF4NY.js";import"./chunk-YVBCZ55L.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-O4PCMGUI.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{h as O,i as m}from"./chunk-OYAVQN5W.js";var wt=(()=>{let t=class t{http;prefix;suffix;constructor(o,i="/assets/i18n/",r=".json"){this.http=o,this.prefix=i,this.suffix=r}getTranslation(o){return this.http.get(`${this.prefix}${o}${this.suffix}`)}};O(t,"\u0275fac",function(i){return new(i||t)(n(T),n(String),n(String))}),O(t,"\u0275prov",g({token:t,factory:t.\u0275fac}));let e=t;return e})();var Pt=(()=>{let t=class t{constructor(o,i){this.authService=o,this.router=i}canActivate(){return this.authService.isAuthenticated$.pipe(V(1),B(o=>o?!0:(this.router.navigate(["/login"]),!1)))}};t.\u0275fac=function(i){return new(i||t)(n(l),n(I))},t.\u0275prov=g({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var At=[{path:"",redirectTo:"tabs",pathMatch:"full"},{path:"login",loadComponent:()=>import("./chunk-GLBJ35MX.js").then(e=>e.LoginPage)},{path:"settings",loadComponent:()=>import("./chunk-4TUH7J4Y.js").then(e=>e.SettingsPage)},{path:"tabs",canActivate:[Pt],loadChildren:()=>import("./chunk-3N34GOTL.js").then(e=>e.routes)}];var Rt=(()=>{let t=class t{constructor(o,i,r){this.toastController=o,this.router=i,this.authService=r}intercept(o,i){return i.handle(o).pipe(z(r=>{var S,H;let c="An error occurred";return r.error instanceof ErrorEvent?c=`Error: ${r.error.message}`:r.status===401?(this.authService.logout(),this.router.navigate(["/login"]),c="Session expired. Please log in again."):(H=(S=r.error)==null?void 0:S.error)!=null&&H.message?c=r.error.error.message:c=`Error Code: ${r.status}
Message: ${r.message}`,this.presentErrorToast(c),N(()=>r)}))}presentErrorToast(o){return m(this,null,function*(){yield(yield this.toastController.create({message:o,duration:3e3,position:"bottom",color:"danger",buttons:[{text:"Dismiss",role:"cancel"}]})).present()})}};t.\u0275fac=function(i){return new(i||t)(n(ht),n(I),n(l))},t.\u0275prov=g({token:t,factory:t.\u0275fac});let e=t;return e})();function Ot(e,t){if(e&1&&(a(0,"ion-item")(1,"ion-label")(2,"h2"),b(3),d(),a(4,"p"),b(5),d()()()),e&2){let s=t.ngIf;u(3),L(s.name),u(2),L(s.email)}}var Et=(()=>{let t=class t{constructor(o,i){this.authService=o,this.popoverController=i,this.userSession$=this.authService.userSession$}logout(){this.popoverController.dismiss(null,"logout")}};t.\u0275fac=function(i){return new(i||t)(p(l),p($))},t.\u0275cmp=_({type:t,selectors:[["app-profile-menu"]],decls:7,vars:3,consts:[[4,"ngIf"],["button","",3,"click"],["slot","start","name","log-out-outline"]],template:function(i,r){i&1&&(a(0,"ion-list"),h(1,Ot,6,2,"ion-item",0),j(2,"async"),a(3,"ion-item",1),x("click",function(){return r.logout()}),v(4,"ion-icon",2),a(5,"ion-label"),b(6,"Logout"),d()()()),i&2&&(u(),f("ngIf",w(2,1,r.userSession$)))},dependencies:[A,M,P,dt,ut,ft,k],styles:["ion-list[_ngcontent-%COMP%]{margin:0;padding:0}h2[_ngcontent-%COMP%]{font-weight:500;margin:0}p[_ngcontent-%COMP%]{margin:4px 0 0;color:var(--ion-color-medium)}"]});let e=t;return e})();function Lt(e,t){if(e&1&&v(0,"img",7),e&2){let s=y().ngIf;f("src",s.picture,J)}}function Dt(e,t){e&1&&v(0,"ion-icon",8)}function Ht(e,t){if(e&1){let s=Q();a(0,"ion-buttons",2)(1,"ion-button",3),x("click",function(i){W(s);let r=y(2);return G(r.showProfileMenu(i))}),a(2,"ion-avatar",4),h(3,Lt,1,1,"img",5)(4,Dt,1,0,"ion-icon",6),d()()()}if(e&2){let s=t.ngIf;u(3),f("ngIf",s.picture),u(),f("ngIf",!s.picture)}}function Nt(e,t){if(e&1&&(h(0,Ht,5,2,"ion-buttons",1),j(1,"async")),e&2){let s=y();f("ngIf",w(1,1,s.userSession$))}}var $t=(()=>{let t=class t{constructor(o,i,r,c,S){this.authService=o,this.router=i,this.popoverController=r,this.route=c,this.clubContext=S,xt({personCircleOutline:bt,logOutOutline:yt}),this.userSession$=this.authService.userSession$}ngOnInit(){return m(this,null,function*(){this.route.queryParams.subscribe(o=>m(this,null,function*(){let i=o.sportsClubId;i&&this.clubContext.setSportsClubId(i),this.clubContext.getSportsClubId()||(yield this.router.navigate(["/settings"]))}));try{yield St.initialize({google:{webClientId:Ct.googleSignInClientId}})}catch(o){console.error("Failed to initialize Social Login:",o)}})}showProfileMenu(o){return m(this,null,function*(){let i=yield this.popoverController.create({component:Et,event:o,translucent:!0});yield i.present();let{role:r}=yield i.onWillDismiss();r==="logout"&&(yield this.authService.logout(),yield this.router.navigate(["/login"]))})}};t.\u0275fac=function(i){return new(i||t)(p(l),p(I),p($),p(ot),p(jt))},t.\u0275cmp=_({type:t,selectors:[["app-root"]],features:[X([{provide:R,useClass:E},{provide:tt,useClass:Rt,multi:!0}])],decls:4,vars:0,consts:[["userProfile",""],["slot","end",4,"ngIf"],["slot","end"],[3,"click"],["slot","icon-only"],[3,"src",4,"ngIf"],["name","person-circle-outline",4,"ngIf"],[3,"src"],["name","person-circle-outline"]],template:function(i,r){i&1&&(a(0,"ion-app"),v(1,"ion-router-outlet"),d(),h(2,Nt,2,3,"ng-template",null,0,Y))},dependencies:[A,M,P,pt,at,ct,k,mt,lt,it],encapsulation:2});let e=t;return e})();var kt=(()=>{let t=class t{constructor(o){this.storage=o,this.init()}init(){return m(this,null,function*(){yield this.storage.create()})}};t.\u0275fac=function(i){return new(i||t)(n(F))},t.\u0275mod=K({type:t}),t.\u0275inj=q({providers:[F],imports:[_t.forRoot({name:"playmate_db",driverOrder:["indexeddb","localstorage"]})]});let e=t;return e})();function Bt(e){return new wt(e,"./assets/i18n/",".json")}Z($t,{providers:[{provide:R,useClass:E},gt(),nt(At,st(rt)),et(),U(kt,It.forRoot({loader:{provide:vt,useFactory:Bt,deps:[T]},defaultLanguage:"en"}))]});export{Bt as createTranslateLoader};
