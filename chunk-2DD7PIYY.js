import{a as Vt}from"./chunk-UIFERVE2.js";import{a as Mt,c as xt}from"./chunk-VOCJS2BN.js";import{C as Ft,H as Lt,I as Rt,J as Bt,L as qt,M as Ut,N as $t,O as Ht,a as kt,c as Ot,d as At,h as It,i as _t,l as Tt,m as Et,q as jt,r as Wt,x as Nt,y as zt}from"./chunk-SUZ7HWAW.js";import{a as vt,e as Pt,f as Gt}from"./chunk-MCKXY4NN.js";import{$ as g,A as _,Ba as X,Fb as it,Gb as rt,Hb as st,Ia as J,Ib as ct,Jb as lt,Kb as dt,Ma as K,Mb as ht,Na as Q,Pb as mt,Q as b,Qa as Z,R as F,Ra as tt,Sa as et,T as $,Vb as gt,X as L,Yb as ut,Z as D,_b as pt,aa as f,ac as ft,ba as C,c as I,cb as nt,dc as yt,ec as bt,fb as at,fc as wt,ha as T,ia as j,j as E,kb as ot,nc as St,pc as Dt,ra as w,sa as W,sc as Ct,ta as R,va as H,wa as G,x as U,xa as V,za as Y}from"./chunk-YACDG7AY.js";import"./chunk-GRX4ZZSO.js";import"./chunk-7KGURMOZ.js";import"./chunk-T47TWMLD.js";import"./chunk-Y2YV2HED.js";import"./chunk-EDCKRRWH.js";import"./chunk-SPCCATGZ.js";import"./chunk-YKMIF4NY.js";import"./chunk-YVBCZ55L.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-D5MTWDX2.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{a as v,b as P,i as y}from"./chunk-OYAVQN5W.js";var S=(()=>{let r=class r{static openDB(){return new Promise((t,n)=>{let e=indexedDB.open(r.dbName,r.version);e.onupgradeneeded=o=>{let a=o.target.result;if(!a.objectStoreNames.contains(r.storeName)){let i=a.createObjectStore(r.storeName,{keyPath:"id"});i.createIndex("memberId","memberId",{unique:!1}),i.createIndex("date","date",{unique:!1}),i.createIndex("membershipStatus","membershipStatus",{unique:!1}),i.createIndex("dateRange",["date","memberId"],{unique:!1})}},e.onsuccess=()=>t(e.result),e.onerror=()=>n(e.error)})}static getAll(){return y(this,null,function*(){let t=yield r.openDB();return new Promise((n,e)=>{let i=t.transaction(r.storeName,"readonly").objectStore(r.storeName).getAll();i.onsuccess=()=>{let c=i.result.map(d=>P(v({},d),{date:new Date(d.date),checkInTime:new Date(d.checkInTime),checkOutTime:d.checkOutTime?new Date(d.checkOutTime):void 0}));n(c)},i.onerror=()=>e(i.error)})})}static setAll(t){return y(this,null,function*(){let n=yield r.openDB();return new Promise((e,o)=>{var m;let a=n.transaction(r.storeName,"readwrite"),i=a.objectStore(r.storeName);i.clear();for(let c of t){let d=P(v({},c),{id:(m=c.id)!=null?m:c.ID,date:new Date(c.date),checkInTime:new Date(c.checkInTime),checkOutTime:c.checkOutTime?new Date(c.checkOutTime):void 0});i.put(d)}a.oncomplete=()=>e(),a.onerror=()=>o(a.error)})})}static addRecords(t){return y(this,null,function*(){let n=yield r.openDB();return new Promise((e,o)=>{var m;let a=n.transaction(r.storeName,"readwrite"),i=a.objectStore(r.storeName);for(let c of t){let d=P(v({},c),{id:(m=c.id)!=null?m:c.ID,date:new Date(c.date),checkInTime:new Date(c.checkInTime),checkOutTime:c.checkOutTime?new Date(c.checkOutTime):void 0});i.put(d)}a.oncomplete=()=>e(),a.onerror=()=>o(a.error)})})}static getByDateRange(t,n){return y(this,null,function*(){let e=yield r.openDB();return new Promise((o,a)=>{let c=e.transaction(r.storeName,"readonly").objectStore(r.storeName).index("date"),d=IDBKeyRange.bound(t,n),l=c.getAll(d);l.onsuccess=()=>{let O=l.result.map(x=>P(v({},x),{date:new Date(x.date),checkInTime:new Date(x.checkInTime),checkOutTime:x.checkOutTime?new Date(x.checkOutTime):void 0}));o(O)},l.onerror=()=>a(l.error)})})}static getByMemberId(t){return y(this,null,function*(){let n=yield r.openDB();return new Promise((e,o)=>{let c=n.transaction(r.storeName,"readonly").objectStore(r.storeName).index("memberId").getAll(t);c.onsuccess=()=>{let l=c.result.map(p=>P(v({},p),{date:new Date(p.date),checkInTime:new Date(p.checkInTime),checkOutTime:p.checkOutTime?new Date(p.checkOutTime):void 0}));e(l)},c.onerror=()=>o(c.error)})})}static getLastAttendanceId(){return y(this,null,function*(){try{return localStorage.getItem("playmate_lastAttendanceId")}catch(t){return console.error("Error getting last attendance ID from localStorage:",t),null}})}static setLastAttendanceId(t){return y(this,null,function*(){try{localStorage.setItem("playmate_lastAttendanceId",t)}catch(n){throw console.error("Error setting last attendance ID to localStorage:",n),n}})}static getLastSyncTime(){return y(this,null,function*(){try{let t=localStorage.getItem("playmate_lastSyncTime");return t?new Date(t):null}catch(t){return console.error("Error getting last sync time from localStorage:",t),null}})}static setLastSyncTime(t){return y(this,null,function*(){try{localStorage.setItem("playmate_lastSyncTime",t.toISOString())}catch(n){throw console.error("Error setting last sync time to localStorage:",n),n}})}static clearSettings(){try{localStorage.removeItem("playmate_lastAttendanceId"),localStorage.removeItem("playmate_lastSyncTime")}catch(t){console.error("Error clearing attendance settings from localStorage:",t)}}};r.dbName="PlayMateDB",r.storeName="attendance",r.version=2;let h=r;return h})();var Yt=(()=>{let r=class r{constructor(t,n,e,o){this.http=t,this.authService=n,this.clubContext=e,this.memberService=o,this.apiUrl=vt.apiUrl,this.attendanceSubject=new I([]),this.analyticsSubject=new I(null),this.loadingSubject=new I(!1),this.lastSyncSubject=new I(null),this.attendance$=this.attendanceSubject.asObservable(),this.analytics$=this.analyticsSubject.asObservable(),this.loading$=this.loadingSubject.asObservable(),this.lastSync$=this.lastSyncSubject.asObservable(),this.attendanceSubject.next([]),this.analyticsSubject.next(null),this.loadingSubject.next(!1),this.lastSyncSubject.next(null),setTimeout(()=>this.loadCachedData(),1e3)}loadCachedData(){return y(this,null,function*(){try{console.log("Loading cached attendance data...");let t=yield S.getAll(),n=yield S.getLastSyncTime();console.log("Cached attendance records:",t.length),t.length>0&&(this.attendanceSubject.next(t),this.calculateAnalytics(t)),this.lastSyncSubject.next(n)}catch(t){console.error("Error loading cached data:",t)}})}initializeData(){return y(this,null,function*(){try{this.loadingSubject.next(!0),yield this.loadCachedData();let t=yield S.getLastSyncTime();(this.attendanceSubject.value.length===0||!t||new Date().getTime()-t.getTime()>5*60*1e3)&&this.syncAttendance().catch(e=>{console.error("Background sync failed:",e)})}catch(t){console.error("Error initializing attendance data:",t)}finally{this.loadingSubject.next(!1)}})}syncAttendance(t=!1){return y(this,null,function*(){var n;try{this.loadingSubject.next(!0);let e=yield this.authService.getAuthToken(),o=this.clubContext.getSportsClubId()||"";console.log("Attendance sync - Token:",e?"Present":"Missing"),console.log("Attendance sync - Club ID:",o);let a={};if(!t){let l=yield S.getLastAttendanceId();l&&(a.lastAttendanceId=l)}let i=new tt().set("action","getAttendance").set("sportsClubId",o).set("authorization",e?"Bearer "+e:"");Object.keys(a).length>0&&(i=i.set("payload",JSON.stringify(a)));let c={headers:new Z({"Content-Type":"text/plain;charset=utf-8"}),params:i,responseType:"json",observe:"body"},d=yield this.http.get(this.apiUrl,c).toPromise();if((d==null?void 0:d.status)==="error")throw new Error(((n=d.error)==null?void 0:n.message)||"API returned error status");if((d==null?void 0:d.status)==="success"&&d.data){let l=Array.isArray(d.data)?d.data:[d.data];if(l=yield this.linkWithMemberData(l),t||!(yield S.getLastAttendanceId())?yield S.setAll(l):yield S.addRecords(l),l.length>0){let O=Math.max(...l.map(x=>parseInt(x.id||"0"))).toString();yield S.setLastAttendanceId(O)}yield S.setLastSyncTime(new Date),this.lastSyncSubject.next(new Date);let p=yield S.getAll();this.attendanceSubject.next(p),this.calculateAnalytics(p)}}catch(e){throw console.error("Error syncing attendance:",e),e}finally{this.loadingSubject.next(!1)}})}linkWithMemberData(t){return y(this,null,function*(){try{console.log("Linking attendance records with member data:",t.length);let n=yield new Promise((o,a)=>{let i=setTimeout(()=>{console.warn("Member service timeout, proceeding without member data"),o([])},5e3);this.memberService.getMembers().subscribe({next:m=>{clearTimeout(i),console.log("Members fetched for linking:",m.members.length),o(m.members)},error:m=>{clearTimeout(i),console.error("Error fetching members:",m),o([])}})}),e=new Map(n.map(o=>[o.id,o]));return console.log("Member map created with",e.size,"members"),t.map(o=>{let a=e.get(o.memberId),i=P(v({},o),{memberName:a?`${a.firstName} ${a.lastName}`.trim():"Unknown Member",membershipStatus:o.membershipStatus||"unknown"});return!a&&n.length>0&&console.warn("Member not found for attendance record:",o.memberId),i})}catch(n){return console.error("Error linking member data:",n),t}})}getFilteredAttendance(t){return this.attendance$.pipe(E(n=>this.applyFilters(n,t)))}applyFilters(t,n){let e=[...t];if(n.startDate&&(e=e.filter(o=>new Date(o.date)>=n.startDate)),n.endDate&&(e=e.filter(o=>new Date(o.date)<=n.endDate)),n.memberId&&(e=e.filter(o=>o.memberId===n.memberId)),n.membershipStatus&&n.membershipStatus!=="all"&&(e=e.filter(o=>o.membershipStatus===n.membershipStatus)),n.searchTerm){let o=n.searchTerm.toLowerCase();e=e.filter(a=>{var i,m;return((i=a.memberName)==null?void 0:i.toLowerCase().includes(o))||((m=a.notes)==null?void 0:m.toLowerCase().includes(o))})}return e}calculateAnalytics(t){var q;if(t.length===0){this.analyticsSubject.next(null);return}let n=new Map,e=new Map,o=new Map;t.forEach(s=>{let u=new Date(s.date).toDateString(),A=new Date(s.checkInTime).getHours();n.has(u)||n.set(u,{date:u,totalCheckins:0,activeMembers:0,expiredMembers:0,averageDuration:0,uniqueMembers:0});let k=n.get(u);k.totalCheckins++,s.membershipStatus==="active"?k.activeMembers++:s.membershipStatus==="expired"&&k.expiredMembers++,s.duration&&(k.averageDuration=(k.averageDuration+s.duration)/2),e.has(s.memberId)||e.set(s.memberId,new Set),e.get(s.memberId).add(u),o.set(A,(o.get(A)||0)+1)}),n.forEach((s,u)=>{let A=0;e.forEach(k=>{k.has(u)&&A++}),s.uniqueMembers=A});let a=Array.from(n.values()).sort((s,u)=>new Date(s.date).getTime()-new Date(u.date).getTime()),i=a.map(s=>s.totalCheckins),m=e.size,c=i.reduce((s,u)=>s+u,0)/i.length||0,d=Math.min(...i)||0,l=Math.max(...i)||0,p=t.filter(s=>s.membershipStatus==="active").length,O=t.filter(s=>s.membershipStatus==="expired").length,x=O>0?p/O:p,N=new Map;a.forEach(s=>{let u=new Date(s.date).toLocaleDateString("en-US",{weekday:"long"});N.set(u,(N.get(u)||0)+s.totalCheckins)});let Xt=((q=Array.from(N.entries()).sort((s,u)=>u[1]-s[1])[0])==null?void 0:q[0])||"Monday",B=a.slice(-14),z=B.slice(0,7).reduce((s,u)=>s+u.totalCheckins,0),Jt=B.slice(7,14).reduce((s,u)=>s+u.totalCheckins,0),Kt=z>0?(Jt-z)/z*100:0,Qt=Array.from(o.entries()).map(([s,u])=>({hour:s,count:u})).sort((s,u)=>u.count-s.count).slice(0,5),Zt={dailyStats:a,summary:{totalActiveUsers:m,averageDaily:Math.round(c*100)/100,minDaily:d,maxDaily:l,activeVsExpiredRatio:Math.round(x*100)/100,totalAttendanceRecords:t.length},trends:{weeklyGrowth:Math.round(Kt*100)/100,mostActiveDay:Xt,peakHours:Qt}};this.analyticsSubject.next(Zt)}refreshData(){return y(this,null,function*(){yield this.syncAttendance(!0)})}loadData(){return y(this,null,function*(){yield this.initializeData()})}getAttendanceByMember(t){return this.attendance$.pipe(E(n=>n.filter(e=>e.memberId===t)))}getAttendanceByDateRange(t,n){return this.attendance$.pipe(E(e=>e.filter(o=>{let a=new Date(o.date);return a>=t&&a<=n})))}};r.\u0275fac=function(n){return new(n||r)(_(et),_(Pt),_(Gt),_(Vt))},r.\u0275prov=U({token:r,factory:r.\u0275fac,providedIn:"root"});let h=r;return h})();function ne(h,r){h&1&&C(0,"ion-spinner",19)}function ae(h,r){h&1&&C(0,"ion-icon",20)}function oe(h,r){h&1&&(g(0,"div",21),C(1,"ion-spinner",19),g(2,"ion-text",22),w(3,"Loading attendance data..."),f()())}function ie(h,r){if(h&1&&(g(0,"div",23)(1,"div",24)(2,"div",25),C(3,"ion-icon",26),f(),g(4,"div",27),w(5,"Active Users"),f(),g(6,"div",28),w(7),f()(),g(8,"div",24)(9,"div",29),C(10,"ion-icon",30),f(),g(11,"div",27),w(12,"Avg Daily"),f(),g(13,"div",28),w(14),Y(15,"number"),f()()()),h&2){let M=j();b(7),W(M.uniqueMembersCount),b(7),W(X(15,2,M.averageAttendance,"1.0-1"))}}function re(h,r){if(h&1&&(g(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),w(3),f()(),g(4,"ion-card-content")(5,"div",31),C(6,"google-chart",32),f()()()),h&2){let M=j();b(3),W(M.getChartTitle()),b(3),D("type",M.chartType)("data",M.chartData)("columns",M.chartColumns)("options",M.chartOptions)("height",300)}}function se(h,r){if(h&1&&(g(0,"ion-card")(1,"ion-card-content",33),C(2,"ion-icon",34),g(3,"ion-text",22)(4,"h3"),w(5),f(),g(6,"p"),w(7,"There are no attendance records for this period."),f(),g(8,"p"),w(9,"Try changing the date range or refresh the data."),f()()()()),h&2){let M=j();b(5),R("No Data for ",M.getCurrentPeriodText(),"")}}var Ie=(()=>{let r=class r{constructor(t,n){this.attendanceService=t,this.toastController=n,this.loading=!0,this.refreshing=!1,this.viewPeriod="weekly",this.currentDate=new Date,this.currentWeekStart=new Date,this.currentMonth=new Date,this.dailyData=[],this.chartData=[],this.chartColumns=["Date","Attendance",{type:"string",role:"tooltip"},{type:"string",role:"annotation"}],this.chartType=Mt.ColumnChart,this.uniqueMembersCount=0,this.averageAttendance=0,this.highestAttendance={day:"",count:0},this.lowestAttendance={day:"",count:0},this.daysWithNoAttendance=0,this.totalAttendanceCount=0,this.expiredMembershipsCount=0,this.hasDataForCurrentPeriod=!1,this.chartOptions={backgroundColor:"transparent",colors:["#4CAF50"],chartArea:{left:60,top:20,width:"85%",height:"75%"},hAxis:{textStyle:{fontSize:12,color:"#666"},gridlines:{color:"transparent"}},vAxis:{textStyle:{fontSize:12,color:"#666"},gridlines:{color:"#e0e0e0",count:5},minValue:0},legend:{position:"none"},animation:{startup:!0,duration:1e3,easing:"out"}},kt({refresh:Ft,chevronBackOutline:Tt,chevronForwardOutline:Et,peopleOutline:zt,calendarOutline:_t,trendingUpOutline:Ht,trendingDownOutline:Ut,statsChartOutline:Rt,eyeOutline:Wt,analyticsOutline:At,timeOutline:Bt,people:Nt,calendar:It,statsChart:Lt,trendingUp:$t,trendingDown:qt,eye:jt,analytics:Ot}),this.setCurrentWeekStart(),this.currentMonth=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth(),1)}ngOnInit(){this.loadAttendanceData()}loadAttendanceData(){return y(this,null,function*(){try{this.loading=!0,console.log("Loading attendance data from IndexedDB...");let t=yield S.getAll();console.log("Loaded records:",t.length);let n=this.getDateRangeForCurrentView(),e=new Date(n[0]),o=new Date(n[n.length-1]);o.setHours(23,59,59,999);let a=t.filter(i=>{let m=new Date(i.date);return m>=e&&m<=o});this.hasDataForCurrentPeriod=a.length>0,this.dailyData=this.calculateDailyAttendance(t),this.chartData=this.prepareChartData(this.dailyData),this.calculateStatistics(this.dailyData,t),this.updateChartOptions(),console.log("Daily data:",this.dailyData),console.log("Chart data:",this.chartData),console.log("Has data for current period:",this.hasDataForCurrentPeriod)}catch(t){console.error("Error loading attendance data:",t)}finally{this.loading=!1}})}calculateDailyAttendance(t){let n=new Map;t.forEach(a=>{let i=new Date(a.date).toISOString().split("T")[0];n.set(i,(n.get(i)||0)+1)});let e=this.getDateRangeForCurrentView(),o=[];return e.forEach(a=>{let i=n.get(a)||0;o.push({date:a,count:i})}),o}getDateRangeForCurrentView(){let t=[];switch(this.viewPeriod){case"weekly":for(let a=0;a<7;a++){let i=new Date(this.currentWeekStart);i.setDate(this.currentWeekStart.getDate()+a),t.push(i.toISOString().split("T")[0])}break;case"monthly":let n=this.currentMonth.getFullYear(),e=this.currentMonth.getMonth(),o=new Date(n,e+1,0).getDate();for(let a=1;a<=o;a++){let i=new Date(n,e,a);t.push(i.toISOString().split("T")[0])}break;default:for(let a=29;a>=0;a--){let i=new Date(this.currentDate);i.setDate(this.currentDate.getDate()-a),t.push(i.toISOString().split("T")[0])}break}return t}setCurrentWeekStart(){let t=new Date,n=t.getDay(),e=n===0?6:n-1;this.currentWeekStart=new Date(t),this.currentWeekStart.setDate(t.getDate()-e),this.currentWeekStart.setHours(0,0,0,0)}prepareChartData(t){return!t||t.length===0?[]:(t.sort((n,e)=>new Date(n.date).getTime()-new Date(e.date).getTime()),t.map(n=>{let e=n.count||0;return[this.formatDate(n.date),e,`${n.date}: ${e} ${e===1?"person":"people"}`,e.toString()]}))}calculateStatistics(t,n){if(!t||t.length===0){this.uniqueMembersCount=0,this.averageAttendance=0,this.highestAttendance={day:"",count:0},this.lowestAttendance={day:"",count:0},this.daysWithNoAttendance=0,this.totalAttendanceCount=0,this.expiredMembershipsCount=0;return}let e=this.getDateRangeForCurrentView(),o=new Date(e[0]),a=new Date(e[e.length-1]);a.setHours(23,59,59,999);let i=n.filter(l=>{let p=new Date(l.date);return p>=o&&p<=a});this.totalAttendanceCount=t.reduce((l,p)=>l+(p.count||0),0),this.averageAttendance=this.totalAttendanceCount/t.length;let m={day:"",count:0},c={day:"",count:Number.MAX_SAFE_INTEGER};t.forEach(l=>{let p=l.count||0;p>m.count&&(m={day:l.date,count:p}),p<c.count&&(c={day:l.date,count:p})}),this.highestAttendance=m,this.lowestAttendance=c.count===Number.MAX_SAFE_INTEGER?{day:"",count:0}:c,this.daysWithNoAttendance=t.filter(l=>!l.count||l.count===0).length,this.expiredMembershipsCount=i.filter(l=>l.membershipStatus==="expired").length;let d=new Set(i.map(l=>l.memberId));this.uniqueMembersCount=d.size}formatDateForDisplay(t,n=this.viewPeriod){let e=new Date(t);switch(n){case"weekly":return e.toLocaleDateString("en-US",{weekday:"short"});case"monthly":return e.toLocaleDateString("en-US",{day:"numeric"});default:return e.toLocaleDateString("en-US",{weekday:"short"})}}formatDate(t){return this.formatDateForDisplay(t)}refreshAttendance(){return y(this,null,function*(){try{this.refreshing=!0,console.log("Refreshing attendance data..."),yield this.attendanceService.syncAttendance(!1),yield this.loadAttendanceData(),console.log("Attendance data refreshed successfully"),yield(yield this.toastController.create({message:"Attendance data refreshed successfully",duration:3e3,color:"success",position:"top"})).present()}catch(t){console.error("Error refreshing attendance data:",t),yield(yield this.toastController.create({message:"Failed to refresh attendance data",duration:3e3,color:"danger",position:"top"})).present()}finally{this.refreshing=!1}})}onPeriodChange(t){this.viewPeriod=t.detail.value,console.log("Period changed to:",this.viewPeriod),this.viewPeriod==="weekly"?this.setCurrentWeekStart():this.viewPeriod==="monthly"&&(this.currentMonth=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth(),1)),this.loadAttendanceData()}goToPreviousWeek(){this.currentWeekStart.setDate(this.currentWeekStart.getDate()-7),this.loadAttendanceData()}goToNextWeek(){this.currentWeekStart.setDate(this.currentWeekStart.getDate()+7),this.loadAttendanceData()}goToPreviousMonth(){this.currentMonth.setMonth(this.currentMonth.getMonth()-1),this.loadAttendanceData()}goToNextMonth(){this.currentMonth.setMonth(this.currentMonth.getMonth()+1),this.loadAttendanceData()}getCurrentPeriodText(){switch(this.viewPeriod){case"weekly":let t=new Date(this.currentWeekStart);return t.setDate(this.currentWeekStart.getDate()+6),`${this.currentWeekStart.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`;case"monthly":return this.currentMonth.toLocaleDateString("en-US",{year:"numeric",month:"long"});default:return"This Week"}}getChartTitle(){return`${this.viewPeriod.charAt(0).toUpperCase()+this.viewPeriod.slice(1)} Attendance Analytics`}canGoToNextWeek(){let t=new Date(this.currentWeekStart);return t.setDate(this.currentWeekStart.getDate()+7),t<=new Date}canGoToNextMonth(){let t=new Date(this.currentMonth);t.setMonth(this.currentMonth.getMonth()+1);let n=new Date;return t<=new Date(n.getFullYear(),n.getMonth(),1)}updateChartOptions(){let t=this.chartData.length>0?Math.max(...this.chartData.map(n=>n[1]),10)*1.1:10;this.chartOptions={backgroundColor:"transparent",colors:["#4CAF50"],chartArea:{left:60,top:20,width:this.viewPeriod==="monthly"&&this.chartData.length>20?"80%":"85%",height:"75%"},hAxis:{textStyle:{fontSize:12,color:"#666"},gridlines:{color:"transparent"}},vAxis:{textStyle:{fontSize:12,color:"#666"},gridlines:{color:"#e0e0e0",count:5},minValue:0,viewWindow:{min:0,max:t}},legend:{position:"none"},animation:{startup:!0,duration:1e3,easing:"out"},annotations:{textStyle:{fontSize:12,color:"#fff",bold:!0},alwaysOutside:!1,stem:{color:"transparent",length:0}}}}};r.\u0275fac=function(n){return new(n||r)(F(Yt),F(St))},r.\u0275cmp=$({type:r,selectors:[["app-attendance"]],decls:32,vars:12,consts:[[3,"translucent"],["color","primary"],["slot","start"],["slot","end"],[3,"click","disabled"],["name","crescent",4,"ngIf"],["name","refresh","slot","icon-only",4,"ngIf"],["mode","ios",3,"ngModelChange","ionChange","ngModel"],["value","weekly"],["value","monthly"],["fill","clear",3,"click"],["name","chevron-back-outline","slot","icon-only"],["size","small",1,"period-title"],["fill","clear",3,"click","disabled"],["name","chevron-forward-outline","slot","icon-only"],[3,"fullscreen"],["class","loading-container",4,"ngIf"],["class","stats-grid",4,"ngIf"],[4,"ngIf"],["name","crescent"],["name","refresh","slot","icon-only"],[1,"loading-container"],["color","medium"],[1,"stats-grid"],[1,"stat-card"],[1,"stat-icon","active-users"],["name","people"],[1,"stat-label"],[1,"stat-value"],[1,"stat-icon","avg-daily"],["name","calendar"],[2,"display","flex","justify-content","center","align-items","center"],[3,"type","data","columns","options","height"],[1,"no-data"],["name","analytics-outline","size","large","color","medium"]],template:function(n,e){n&1&&(g(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),C(3,"ion-menu-button"),f(),g(4,"ion-title"),w(5,"Attendance Analytics"),f(),g(6,"ion-buttons",3)(7,"ion-button",4),T("click",function(){return e.refreshAttendance()}),L(8,ne,1,0,"ion-spinner",5)(9,ae,1,0,"ion-icon",6),f()()(),g(10,"ion-toolbar")(11,"ion-segment",7),V("ngModelChange",function(a){return G(e.viewPeriod,a)||(e.viewPeriod=a),a}),T("ionChange",function(a){return e.onPeriodChange(a)}),g(12,"ion-segment-button",8)(13,"ion-label"),w(14,"Weekly"),f()(),g(15,"ion-segment-button",9)(16,"ion-label"),w(17,"Monthly"),f()()()(),g(18,"ion-toolbar")(19,"ion-buttons",2)(20,"ion-button",10),T("click",function(){return e.viewPeriod==="weekly"?e.goToPreviousWeek():e.goToPreviousMonth()}),C(21,"ion-icon",11),f()(),g(22,"ion-title",12),w(23),f(),g(24,"ion-buttons",3)(25,"ion-button",13),T("click",function(){return e.viewPeriod==="weekly"?e.goToNextWeek():e.goToNextMonth()}),C(26,"ion-icon",14),f()()()(),g(27,"ion-content",15),L(28,oe,4,0,"div",16)(29,ie,16,5,"div",17)(30,re,7,6,"ion-card",18)(31,se,10,1,"ion-card",18),f()),n&2&&(D("translucent",!0),b(7),D("disabled",e.loading||e.refreshing),b(),D("ngIf",e.refreshing),b(),D("ngIf",!e.refreshing),b(2),H("ngModel",e.viewPeriod),b(12),R(" ",e.getCurrentPeriodText()," "),b(2),D("disabled",e.viewPeriod==="weekly"?!e.canGoToNextWeek():!e.canGoToNextMonth()),b(2),D("fullscreen",!0),b(),D("ngIf",e.loading),b(),D("ngIf",!e.loading&&e.hasDataForCurrentPeriod),b(),D("ngIf",!e.loading&&e.hasDataForCurrentPeriod),b(),D("ngIf",!e.loading&&!e.hasDataForCurrentPeriod))},dependencies:[Q,J,K,ot,nt,at,mt,wt,bt,ht,st,lt,dt,ct,ft,yt,rt,ut,it,Dt,Ct,pt,gt,xt],styles:[".loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem;gap:1rem}.period-title[_ngcontent-%COMP%]{text-align:center;font-size:1rem;font-weight:500}.no-data[_ngcontent-%COMP%]{text-align:center;padding:2rem;display:flex;flex-direction:column;align-items:center;gap:1rem}.no-data[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:.5rem}.no-data[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin-bottom:.5rem}.no-data[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium-tint);margin:.25rem 0}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px;padding:12px}.stat-card[_ngcontent-%COMP%]{background-color:var(--ion-card-background);border-radius:8px;padding:16px;display:flex;flex-direction:column;align-items:flex-start;box-shadow:0 4px 6px #0000001a}.stat-icon[_ngcontent-%COMP%]{width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:50%;margin-bottom:12px}.stat-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:#fff}.stat-icon.active-users[_ngcontent-%COMP%]{background-color:#e53935}.stat-icon.avg-daily[_ngcontent-%COMP%]{background-color:#3949ab}.stat-label[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-medium);margin-bottom:4px;text-transform:uppercase;letter-spacing:.5px}.stat-value[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:var(--ion-color-dark)}.stat-label[_ngcontent-%COMP%]{font-size:12px;color:#888;margin-bottom:4px}.stat-value[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#fff}.insights-section[_ngcontent-%COMP%]{padding:0 12px;margin-top:12px}.insights-section[_ngcontent-%COMP%]   .insights-title[_ngcontent-%COMP%]{font-size:16px;color:#fff;display:flex;align-items:center;margin:0 0 12px}.insights-section[_ngcontent-%COMP%]   .insights-title[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:8px}.insights-section[_ngcontent-%COMP%]   .insight-item[_ngcontent-%COMP%]{background-color:#1e1e1e;border-radius:8px;padding:12px 16px;margin-bottom:12px}.insights-section[_ngcontent-%COMP%]   .insight-item[_ngcontent-%COMP%]   .insight-content[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:6px}.insights-section[_ngcontent-%COMP%]   .insight-item[_ngcontent-%COMP%]   .insight-content[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:8px;font-size:18px}.insights-section[_ngcontent-%COMP%]   .insight-item[_ngcontent-%COMP%]   .insight-content[_ngcontent-%COMP%]   ion-icon.negative[_ngcontent-%COMP%]{color:#e53935}.insights-section[_ngcontent-%COMP%]   .insight-item[_ngcontent-%COMP%]   .insight-content[_ngcontent-%COMP%]   .insight-title[_ngcontent-%COMP%]{font-size:14px;color:#fff;flex-grow:1}.insights-section[_ngcontent-%COMP%]   .insight-item[_ngcontent-%COMP%]   .insight-content[_ngcontent-%COMP%]   .insight-value[_ngcontent-%COMP%]{font-weight:600;font-size:14px}.insights-section[_ngcontent-%COMP%]   .insight-item[_ngcontent-%COMP%]   .insight-content[_ngcontent-%COMP%]   .insight-value.negative[_ngcontent-%COMP%]{color:#e53935}.insights-section[_ngcontent-%COMP%]   .insight-item[_ngcontent-%COMP%]   .insight-description[_ngcontent-%COMP%]{font-size:13px;color:#888}.bottom-tabs[_ngcontent-%COMP%]{display:flex;justify-content:space-around;background-color:#1a1a1a;padding:10px 0;position:fixed;bottom:0;left:0;right:0;z-index:10;border-top:1px solid #333333}.bottom-tabs[_ngcontent-%COMP%]   .tab-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;flex:1}.bottom-tabs[_ngcontent-%COMP%]   .tab-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:#888}.bottom-tabs[_ngcontent-%COMP%]   .tab-item[_ngcontent-%COMP%]   .tab-label[_ngcontent-%COMP%]{font-size:10px;margin-top:4px;color:#888}.bottom-tabs[_ngcontent-%COMP%]   .tab-item.active[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#e53935}.bottom-tabs[_ngcontent-%COMP%]   .tab-item.active[_ngcontent-%COMP%]   .tab-label[_ngcontent-%COMP%]{color:#e53935}"]});let h=r;return h})();export{Ie as AttendancePage};
