import{A as l,B as O,C as E,Da as P,F as u,I as W,L as o,M as R,N as C,R as c,T as p,W as F,a as S,b as z,d as f,g as v,ga as M,j as D,ja as T,k as m,ka as x,l as j,ma as G,oa as k,p as L,pa as B,s as A,v as I,x as b,z as w}from"./chunk-YACDG7AY.js";import{a as h}from"./chunk-OYAVQN5W.js";var H=["*"],Q="[_nghost-%COMP%]{width:-moz-fit-content;width:fit-content;display:block}";var s=function(r){return r.AnnotationChart="AnnotationChart",r.AreaChart="AreaChart",r.Bar="Bar",r.BarChart="BarChart",r.BubbleChart="BubbleChart",r.Calendar="Calendar",r.CandlestickChart="CandlestickChart",r.ColumnChart="ColumnChart",r.ComboChart="ComboChart",r.PieChart="PieChart",r.Gantt="Gantt",r.Gauge="Gauge",r.GeoChart="GeoChart",r.Histogram="Histogram",r.Line="Line",r.LineChart="LineChart",r.Map="Map",r.OrgChart="OrgChart",r.Sankey="Sankey",r.Scatter="Scatter",r.ScatterChart="ScatterChart",r.SteppedAreaChart="SteppedAreaChart",r.Table="Table",r.Timeline="Timeline",r.TreeMap="TreeMap",r.WordTree="WordTree",r}(s||{}),U={[s.AnnotationChart]:"annotationchart",[s.AreaChart]:"corechart",[s.Bar]:"bar",[s.BarChart]:"corechart",[s.BubbleChart]:"corechart",[s.Calendar]:"calendar",[s.CandlestickChart]:"corechart",[s.ColumnChart]:"corechart",[s.ComboChart]:"corechart",[s.PieChart]:"corechart",[s.Gantt]:"gantt",[s.Gauge]:"gauge",[s.GeoChart]:"geochart",[s.Histogram]:"corechart",[s.Line]:"line",[s.LineChart]:"corechart",[s.Map]:"map",[s.OrgChart]:"orgchart",[s.Sankey]:"sankey",[s.Scatter]:"scatter",[s.ScatterChart]:"corechart",[s.SteppedAreaChart]:"corechart",[s.Table]:"table",[s.Timeline]:"timeline",[s.TreeMap]:"treemap",[s.WordTree]:"wordtree"};function V(r){return U[r]}function N(){return{version:"current",safeMode:!1}}var $=new w("GOOGLE_CHARTS_CONFIG"),Z=new w("GOOGLE_CHARTS_LAZY_CONFIG",{providedIn:"root",factory:()=>{let r=O($,{optional:!0});return v(h(h({},N()),r||{}))}}),g=(()=>{let i=class i{constructor(e,t,a){this.zone=e,this.localeId=t,this.config$=a,this.scriptSource="https://www.gstatic.com/charts/loader.js",this.scriptLoadSubject=new z}isGoogleChartsAvailable(){return!(typeof google>"u"||typeof google.charts>"u")}loadChartPackages(...e){return this.loadGoogleCharts().pipe(j(()=>this.config$),D(t=>h(h({},N()),t||{})),I(t=>new S(a=>{let n={packages:e,language:this.localeId,mapsApiKey:t.mapsApiKey,safeMode:t.safeMode};google.charts.load(t.version,n),google.charts.setOnLoadCallback(()=>{this.zone.run(()=>{a.next(),a.complete()})})})))}loadGoogleCharts(){if(this.isGoogleChartsAvailable())return v(void 0);if(!this.isLoadingGoogleCharts()){let e=this.createGoogleChartsScript();e.onload=()=>{this.zone.run(()=>{this.scriptLoadSubject.next(),this.scriptLoadSubject.complete()})},e.onerror=()=>{this.zone.run(()=>{console.error("Failed to load the google charts script!"),this.scriptLoadSubject.error(new Error("Failed to load the google charts script!"))})}}return this.scriptLoadSubject.asObservable()}isLoadingGoogleCharts(){return this.getGoogleChartsScript()!=null}getGoogleChartsScript(){return Array.from(document.getElementsByTagName("script")).find(t=>t.src===this.scriptSource)}createGoogleChartsScript(){let e=document.createElement("script");return e.type="text/javascript",e.src=this.scriptSource,e.async=!0,document.getElementsByTagName("head")[0].appendChild(e),e}};i.\u0275fac=function(t){return new(t||i)(l(R),l(P),l(Z))},i.\u0275prov=b({token:i,factory:i.\u0275fac});let r=i;return r})();var y=(()=>{let i=class i{create(e,t,a){if(e==null)return;let n=!0;t!=null&&(n=!1);let d=google.visualization.arrayToDataTable(this.getDataAsTable(e,t),n);return a&&this.applyFormatters(d,a),d}getDataAsTable(e,t){return t?[t,...e]:e}applyFormatters(e,t){for(let a of t)a.formatter.format(e,a.colIndex)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"});let r=i;return r})();function q(){return"_"+Math.random().toString(36).substr(2,9)}var K=(()=>{let i=class i{constructor(e){this.loaderService=e,this.error=new o,this.ready=new o,this.stateChange=new o,this.id=q(),this.wrapperReadySubject=new f(1)}get wrapperReady$(){return this.wrapperReadySubject.asObservable()}get controlWrapper(){if(!this._controlWrapper)throw new Error("Cannot access the control wrapper before it being initialized.");return this._controlWrapper}ngOnInit(){this.loaderService.loadChartPackages("controls").subscribe(()=>{this.createControlWrapper()})}ngOnChanges(e){this._controlWrapper&&(e.type&&this._controlWrapper.setControlType(this.type),e.options&&this._controlWrapper.setOptions(this.options||{}),e.state&&this._controlWrapper.setState(this.state||{}))}createControlWrapper(){this._controlWrapper=new google.visualization.ControlWrapper({containerId:this.id,controlType:this.type,state:this.state,options:this.options}),this.addEventListeners(),this.wrapperReadySubject.next(this._controlWrapper)}addEventListeners(){google.visualization.events.removeAllListeners(this._controlWrapper),google.visualization.events.addListener(this._controlWrapper,"ready",e=>this.ready.emit(e)),google.visualization.events.addListener(this._controlWrapper,"error",e=>this.error.emit(e)),google.visualization.events.addListener(this._controlWrapper,"statechange",e=>this.stateChange.emit(e))}};i.\u0275fac=function(t){return new(t||i)(c(g))},i.\u0275cmp=p({type:i,selectors:[["control-wrapper"]],hostAttrs:[1,"control-wrapper"],hostVars:1,hostBindings:function(t,a){t&2&&M("id",a.id)},inputs:{for:"for",type:"type",options:"options",state:"state"},outputs:{error:"error",ready:"ready",stateChange:"stateChange"},exportAs:["controlWrapper"],standalone:!1,features:[u],decls:0,vars:0,template:function(t,a){},encapsulation:2,changeDetection:0});let r=i;return r})(),Y=(()=>{let i=class i{constructor(e,t,a){this.element=e,this.loaderService=t,this.dataTableService=a,this.ready=new o,this.error=new o,this.initialized=!1}ngOnInit(){this.loaderService.loadChartPackages("controls").subscribe(()=>{this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.createDashboard(),this.initialized=!0})}ngOnChanges(e){this.initialized&&(e.data||e.columns||e.formatters)&&(this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.dashboard.draw(this.dataTable))}createDashboard(){let e=this.controlWrappers.map(a=>a.wrapperReady$),t=this.controlWrappers.map(a=>a.for).map(a=>Array.isArray(a)?m(a.map(n=>n.wrapperReady$)):a.wrapperReady$);m([...e,...t]).subscribe(()=>{this.dashboard=new google.visualization.Dashboard(this.element.nativeElement),this.initializeBindings(),this.registerEvents(),this.dashboard.draw(this.dataTable)})}registerEvents(){google.visualization.events.removeAllListeners(this.dashboard);let e=(t,a,n)=>{google.visualization.events.addListener(t,a,n)};e(this.dashboard,"ready",()=>this.ready.emit()),e(this.dashboard,"error",t=>this.error.emit(t))}initializeBindings(){this.controlWrappers.forEach(e=>{if(Array.isArray(e.for)){let t=e.for.map(a=>a.chartWrapper);this.dashboard.bind(e.controlWrapper,t)}else this.dashboard.bind(e.controlWrapper,e.for.chartWrapper)})}};i.\u0275fac=function(t){return new(t||i)(c(C),c(g),c(y))},i.\u0275cmp=p({type:i,selectors:[["dashboard"]],contentQueries:function(t,a,n){if(t&1&&G(n,K,4),t&2){let d;k(d=B())&&(a.controlWrappers=d)}},hostAttrs:[1,"dashboard"],inputs:{data:"data",columns:"columns",formatters:"formatters"},outputs:{ready:"ready",error:"error"},exportAs:["dashboard"],standalone:!1,features:[u],ngContentSelectors:H,decls:1,vars:0,template:function(t,a){t&1&&(T(),x(0))},encapsulation:2,changeDetection:0});let r=i;return r})(),J=(()=>{let i=class i{constructor(e,t,a,n){this.element=e,this.scriptLoaderService=t,this.dataTableService=a,this.dashboard=n,this.options={},this.dynamicResize=!1,this.ready=new o,this.error=new o,this.select=new o,this.mouseover=new o,this.mouseleave=new o,this.wrapperReadySubject=new f(1),this.initialized=!1,this.eventListeners=new Map}get chart(){return this.chartWrapper.getChart()}get wrapperReady$(){return this.wrapperReadySubject.asObservable()}get chartWrapper(){if(!this.wrapper)throw new Error("Trying to access the chart wrapper before it was fully initialized");return this.wrapper}set chartWrapper(e){this.wrapper=e,this.drawChart()}ngOnInit(){this.scriptLoaderService.loadChartPackages(V(this.type)).subscribe(()=>{this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.wrapper=new google.visualization.ChartWrapper({container:this.element.nativeElement,chartType:this.type,dataTable:this.dataTable,options:this.mergeOptions()}),this.registerChartEvents(),this.wrapperReadySubject.next(this.wrapper),this.initialized=!0,this.drawChart()})}ngOnChanges(e){if(e.dynamicResize&&this.updateResizeListener(),this.initialized){let t=!1;(e.data||e.columns||e.formatters)&&(this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.wrapper.setDataTable(this.dataTable),t=!0),e.type&&(this.wrapper.setChartType(this.type),t=!0),(e.options||e.width||e.height||e.title)&&(this.wrapper.setOptions(this.mergeOptions()),t=!0),t&&this.drawChart()}}ngOnDestroy(){this.unsubscribeToResizeIfSubscribed()}addEventListener(e,t){let a=this.registerChartEvent(this.chart,e,t);return this.eventListeners.set(a,{eventName:e,callback:t,handle:a}),a}removeEventListener(e){let t=this.eventListeners.get(e);t&&(google.visualization.events.removeListener(t.handle),this.eventListeners.delete(e))}updateResizeListener(){this.unsubscribeToResizeIfSubscribed(),this.dynamicResize&&(this.resizeSubscription=L(window,"resize",{passive:!0}).pipe(A(100)).subscribe(()=>{this.initialized&&this.drawChart()}))}unsubscribeToResizeIfSubscribed(){this.resizeSubscription!=null&&(this.resizeSubscription.unsubscribe(),this.resizeSubscription=void 0)}mergeOptions(){return h({title:this.title,width:this.width,height:this.height},this.options)}registerChartEvents(){google.visualization.events.removeAllListeners(this.wrapper),this.registerChartEvent(this.wrapper,"ready",()=>{google.visualization.events.removeAllListeners(this.chart),this.registerChartEvent(this.chart,"onmouseover",e=>this.mouseover.emit(e)),this.registerChartEvent(this.chart,"onmouseout",e=>this.mouseleave.emit(e)),this.registerChartEvent(this.chart,"select",()=>{let e=this.chart.getSelection();this.select.emit({selection:e})}),this.eventListeners.forEach(e=>e.handle=this.registerChartEvent(this.chart,e.eventName,e.callback)),this.ready.emit({chart:this.chart})}),this.registerChartEvent(this.wrapper,"error",e=>this.error.emit(e))}registerChartEvent(e,t,a){return google.visualization.events.addListener(e,t,a)}drawChart(){this.dashboard==null&&this.wrapper.draw()}};i.\u0275fac=function(t){return new(t||i)(c(C),c(g),c(y),c(Y,8))},i.\u0275cmp=p({type:i,selectors:[["google-chart"]],hostAttrs:[1,"google-chart"],inputs:{type:"type",data:"data",columns:"columns",title:"title",width:"width",height:"height",options:"options",formatters:"formatters",dynamicResize:"dynamicResize"},outputs:{ready:"ready",error:"error",select:"select",mouseover:"mouseover",mouseleave:"mouseleave"},exportAs:["googleChart"],standalone:!1,features:[u],decls:0,vars:0,template:function(t,a){},styles:["[_nghost-%COMP%]{width:-moz-fit-content;width:fit-content;display:block}"],changeDetection:0});let r=i;return r})();function ve(r={}){return E([g,y,{provide:$,useValue:r}])}var me=(()=>{let i=class i extends J{};i.\u0275fac=(()=>{let e;return function(a){return(e||(e=W(i)))(a||i)}})(),i.\u0275cmp=p({type:i,selectors:[["google-chart"]],hostAttrs:[1,"google-chart"],exportAs:["googleChart"],features:[F],decls:0,vars:0,template:function(t,a){},styles:[Q]});let r=i;return r})();export{s as a,ve as b,me as c};
