import{a as Tt,c as Pt}from"./chunk-FDIO45X5.js";import{b as Et}from"./chunk-OLBZNZSH.js";import{a as kt,b as Rt,c as F,d as Ot,e as I,f as Bt}from"./chunk-JUN4HHGW.js";import"./chunk-T47TWMLD.js";import{$ as d,$a as ct,B as c,Ba as nt,Bc as b,E as Y,Ea as w,Fa as A,Gb as R,H as Z,Ha as rt,I as tt,Ib as dt,Ic as H,Lb as gt,Mb as ht,Na as j,Ob as vt,Pb as It,Q as et,Qa as T,R as h,S as m,Sc as Dt,Ta as P,U as S,V as it,Va as st,Vc as $t,Wb as _t,Ya as E,Z as _,Za as at,Zb as Ct,_a as lt,ab as mt,ac as O,bb as k,bc as St,ca as r,cb as v,da as a,dc as D,ea as p,eb as pt,ec as $,fb as ut,fc as bt,fd as Lt,gb as ft,gc as yt,h as W,ia as ot,k as J,ka as g,kd as Ft,la as M,md as Ht,qc as xt,r as K,rc as Mt,td as Nt,u as Q,ua as f,uc as L,va as U,vc as wt,y as C,yc as At,z as X,zc as jt}from"./chunk-AAX3YNDZ.js";import"./chunk-GRX4ZZSO.js";import"./chunk-7KGURMOZ.js";import"./chunk-Y2YV2HED.js";import"./chunk-EDCKRRWH.js";import"./chunk-SPCCATGZ.js";import"./chunk-YKMIF4NY.js";import"./chunk-YVBCZ55L.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-D5MTWDX2.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{h as B,i as u}from"./chunk-OYAVQN5W.js";var Ut=(()=>{let t=class t{http;prefix;suffix;constructor(o,i="/assets/i18n/",n=".json"){this.http=o,this.prefix=i,this.suffix=n}getTranslation(o){return this.http.get(`${this.prefix}${o}${this.suffix}`)}};B(t,"\u0275fac",function(i){return new(i||t)(c(E),c(String),c(String))}),B(t,"\u0275prov",C({token:t,factory:t.\u0275fac}));let e=t;return e})();var N=(()=>{let t=class t{constructor(o,i){this.authService=o,this.router=i}canActivate(){return this.authService.isAuthenticated$.pipe(Q(1),J(o=>o?(console.log("User is authenticated, access granted."),!0):(this.router.navigate(["/login"]),console.log("User is not authenticated, redirecting to login page."),!1)))}};t.\u0275fac=function(i){return new(i||t)(c(I),c(v))},t.\u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var zt=[{path:"",redirectTo:"tabs",pathMatch:"full"},{path:"login",loadComponent:()=>import("./chunk-SJ446T5D.js").then(e=>e.LoginPage)},{path:"settings",canActivate:[N],loadComponent:()=>import("./chunk-F3RSNJZ5.js").then(e=>e.SettingsPage)},{path:"attendance-details",canActivate:[N],loadComponent:()=>import("./chunk-MREA7JZO.js").then(e=>e.AttendanceDetailsPage)},{path:"tabs",canActivate:[N],loadChildren:()=>import("./chunk-27CZO524.js").then(e=>e.routes)}];H({peopleOutline:Ft,cashOutline:$t,calendarOutline:Dt,settingsOutline:Nt});var Vt=(()=>{let t=class t{constructor(o,i){this.router=o,this.menu=i}navigate(o){return u(this,null,function*(){yield this.menu.close(),yield this.router.navigate([o])})}};t.\u0275fac=function(i){return new(i||t)(m(v),m(At))},t.\u0275cmp=S({type:t,selectors:[["app-menu"]],decls:26,vars:0,consts:[["contentId","main-content"],["color","primary"],["button","","detail","",3,"click"],["slot","start","name","people-outline"],["slot","start","name","cash-outline"],["slot","start","name","calendar-outline"],["slot","start","name","settings-outline"]],template:function(i,n){i&1&&(r(0,"ion-menu",0)(1,"ion-header")(2,"ion-toolbar",1)(3,"ion-title"),f(4,"GymMate"),a()()(),r(5,"ion-content")(6,"ion-list")(7,"ion-item",2),g("click",function(){return n.navigate("/tabs/members")}),p(8,"ion-icon",3),r(9,"ion-label"),f(10,"Members"),a()(),r(11,"ion-item",2),g("click",function(){return n.navigate("/tabs/payments")}),p(12,"ion-icon",4),r(13,"ion-label"),f(14,"Payments"),a()(),r(15,"ion-item",2),g("click",function(){return n.navigate("/tabs/attendance")}),p(16,"ion-icon",5),r(17,"ion-label"),f(18,"Attendance"),a()(),r(19,"ion-item-divider")(20,"ion-label"),f(21,"Admin"),a()(),r(22,"ion-item",2),g("click",function(){return n.navigate("/settings")}),p(23,"ion-icon",6),r(24,"ion-label"),f(25,"Settings"),a()()()()())},dependencies:[yt,Ct,Mt,xt,_t,$,O,b,D,St],encapsulation:2});let e=t;return e})();var Gt=(()=>{let t=class t{constructor(o,i,n){this.toastController=o,this.router=i,this.authService=n}intercept(o,i){return i.handle(o).pipe(K(n=>{var x,q;let s="An error occurred";return n.error instanceof ErrorEvent?s=`Error: ${n.error.message}`:n.status===401?(this.authService.logout(),this.router.navigate(["/login"]),s="Session expired. Please log in again."):(q=(x=n.error)==null?void 0:x.error)!=null&&q.message?s=n.error.error.message:s=`Error Code: ${n.status}
Message: ${n.message}`,this.presentErrorToast(s),W(()=>n)}))}presentErrorToast(o){return u(this,null,function*(){yield(yield this.toastController.create({message:o,duration:3e3,position:"bottom",color:"danger",buttons:[{text:"Dismiss",role:"cancel"}]})).present()})}};t.\u0275fac=function(i){return new(i||t)(c(jt),c(v),c(I))},t.\u0275prov=C({token:t,factory:t.\u0275fac});let e=t;return e})();function Qt(e,t){if(e&1&&(r(0,"ion-item")(1,"ion-label")(2,"h2"),f(3),a(),r(4,"p"),f(5),a()()()),e&2){let l=t.ngIf;h(3),U(l.name),h(2),U(l.email)}}var qt=(()=>{let t=class t{constructor(o,i){this.authService=o,this.popoverController=i,this.userSession$=this.authService.userSession$}logout(){this.popoverController.dismiss(null,"logout")}};t.\u0275fac=function(i){return new(i||t)(m(I),m(L))},t.\u0275cmp=S({type:t,selectors:[["app-profile-menu"]],decls:7,vars:3,consts:[[4,"ngIf"],["button","",3,"click"],["slot","start","name","log-out-outline"]],template:function(i,n){i&1&&(r(0,"ion-list"),_(1,Qt,6,2,"ion-item",0),w(2,"async"),r(3,"ion-item",1),g("click",function(){return n.logout()}),p(4,"ion-icon",2),r(5,"ion-label"),f(6,"Logout"),a()()()),i&2&&(h(),d("ngIf",A(2,1,n.userSession$)))},dependencies:[P,j,T,$,O,D,b],styles:["ion-list[_ngcontent-%COMP%]{margin:0;padding:0}h2[_ngcontent-%COMP%]{font-weight:500;margin:0}p[_ngcontent-%COMP%]{margin:4px 0 0;color:var(--ion-color-medium)}"]});let e=t;return e})();function Xt(e,t){if(e&1&&p(0,"ion-loading",3),e&2){let l=M();d("isOpen",l.loading)}}function Yt(e,t){if(e&1&&p(0,"img",10),e&2){let l=M().ngIf;d("src",l.picture,et)}}function Zt(e,t){e&1&&p(0,"ion-icon",11)}function te(e,t){if(e&1){let l=ot();r(0,"ion-buttons",5)(1,"ion-button",6),g("click",function(i){Z(l);let n=M(2);return tt(n.showProfileMenu(i))}),r(2,"ion-avatar",7),_(3,Yt,1,1,"img",8)(4,Zt,1,0,"ion-icon",9),a()()()}if(e&2){let l=t.ngIf;h(3),d("ngIf",l.picture),h(),d("ngIf",!l.picture)}}function ee(e,t){if(e&1&&(_(0,te,5,2,"ion-buttons",4),w(1,"async")),e&2){let l=M();d("ngIf",A(1,1,l.userSession$))}}var Wt=(()=>{let t=class t{constructor(o,i,n,s,x){this.authService=o,this.router=i,this.popoverController=n,this.route=s,this.clubContext=x,this.loading=!1,H({personCircleOutline:Ht,logOutOutline:Lt}),this.userSession$=this.authService.userSession$}ngOnInit(){return u(this,null,function*(){try{yield Rt.initialize({google:{webClientId:kt.googleSignInClientId}})}catch(o){console.error("Failed to initialize Social Login:",o)}yield this.authService.loadSession().catch(o=>{console.error("Error loading session on app init:",o)}),this.authService.isAuthenticated$.subscribe(o=>u(this,null,function*(){if(o){let i=this.router.url;this.route.queryParams.subscribe(n=>u(this,null,function*(){let s=n.sportsClubId;s&&this.clubContext.setSportsClubId(s),!this.clubContext.getSportsClubId()&&!i.includes("/settings")?yield this.router.navigate(["/settings"]):console.log("Active session found, refreshing all data")}))}}))})}showProfileMenu(o){return u(this,null,function*(){let i=yield this.popoverController.create({component:qt,event:o,translucent:!0});yield i.present();let{role:n}=yield i.onWillDismiss();n==="logout"&&(yield this.authService.logout(),yield this.router.navigate(["/login"]))})}};t.\u0275fac=function(i){return new(i||t)(m(I),m(v),m(L),m(mt),m(Bt))},t.\u0275cmp=S({type:t,selectors:[["app-root"]],features:[nt([{provide:k,useClass:R},{provide:at,useClass:Gt,multi:!0}])],decls:6,vars:1,consts:[["userProfile",""],["id","main-content"],["message","Refreshing data...","spinner","crescent","backdropDismiss","false",3,"isOpen",4,"ngIf"],["message","Refreshing data...","spinner","crescent","backdropDismiss","false",3,"isOpen"],["slot","end",4,"ngIf"],["slot","end"],[3,"click"],["slot","icon-only"],[3,"src",4,"ngIf"],["name","person-circle-outline",4,"ngIf"],[3,"src"],["name","person-circle-outline"]],template:function(i,n){i&1&&(r(0,"ion-app"),p(1,"app-menu")(2,"ion-router-outlet",1),_(3,Xt,1,1,"ion-loading",2),a(),_(4,ee,2,3,"ng-template",null,0,rt)),i&2&&(h(3),d("ngIf",n.loading))},dependencies:[P,j,T,gt,dt,ht,b,vt,It,ct,Vt,bt],encapsulation:2});let e=t;return e})();var Jt=(()=>{let t=class t{constructor(o){this.storage=o,this.init()}init(){return u(this,null,function*(){yield this.storage.create()})}};t.\u0275fac=function(i){return new(i||t)(c(F))},t.\u0275mod=it({type:t}),t.\u0275inj=X({providers:[F],imports:[Ot.forRoot({name:"playmate_db",driverOrder:["indexeddb","localstorage"]})]});let e=t;return e})();function ie(e){return new Ut(e,"./assets/i18n/",".json")}st(Wt,{providers:[{provide:k,useClass:R},wt(),ut(zt,ft(pt)),lt(),Et(),Y(Jt,Pt.forRoot({loader:{provide:Tt,useFactory:ie,deps:[E]},defaultLanguage:"en"}))]});export{ie as createTranslateLoader};
