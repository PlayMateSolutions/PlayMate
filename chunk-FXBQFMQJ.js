import{a as W}from"./chunk-NFW2BMYQ.js";import"./chunk-3EZO2L4I.js";import"./chunk-XT6IINF4.js";import"./chunk-T47TWMLD.js";import"./chunk-35HGTZOU.js";import{$ as d,Dc as R,Ea as u,Fa as P,Ga as h,H as I,I as b,Jb as k,Ma as w,Na as T,Nb as F,Pb as N,Qa as L,Qb as Q,R as o,Ra as D,Rb as z,S as x,Sa as B,Ta as $,U as C,Wb as G,Z as g,Zb as H,ac as V,bc as A,ca as i,da as a,dc as U,ea as S,ec as j,ia as O,ic as K,ka as v,la as f,qc as q,rc as J,ua as l,va as E,wa as _,xa as M}from"./chunk-QTDLHZUQ.js";import"./chunk-GRX4ZZSO.js";import"./chunk-7KGURMOZ.js";import"./chunk-Y2YV2HED.js";import"./chunk-EDCKRRWH.js";import"./chunk-SPCCATGZ.js";import"./chunk-YKMIF4NY.js";import"./chunk-YVBCZ55L.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-D5MTWDX2.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import"./chunk-OYAVQN5W.js";function X(e,r){if(e&1&&(i(0,"ion-badge",18),l(1),a()),e&2){let t=f().$implicit;o(),_(" ",t.status," ")}}function Y(e,r){if(e&1){let t=O();i(0,"ion-item",13),v("click",function(){let s=I(t).$implicit,n=f(3);return b(n.showPaymentDetails(s))}),i(1,"ion-label")(2,"h2"),l(3),i(4,"ion-note",14),l(5),a()(),i(6,"ion-note",15),l(7),u(8,"date"),g(9,X,2,1,"ion-badge",16),a()(),i(10,"ion-note",17),l(11),u(12,"number"),a()()}if(e&2){let t=r.$implicit;o(3),_("",t.memberName||"Unknown Member"," "),o(2),_("#",t.memberId,""),o(2),M(" ",h(8,6,t.date,"mediumDate")," \xB7 ",t.paymentType," "),o(2),d("ngIf",t.status!=="active"),o(2),_(" \u20B9",h(12,9,t.amount,"1.0-0")," ")}}function Z(e,r){if(e&1&&(i(0,"div",8)(1,"ion-item-divider",9)(2,"ion-label"),l(3),a(),i(4,"ion-note",10),l(5),u(6,"number"),a()(),i(7,"ion-list",11),g(8,Y,13,12,"ion-item",12),a()()),e&2){let t=r.$implicit;o(3),E(t.formattedDate),o(2),_("\u20B9",h(6,3,t.total,"1.0-0"),""),o(3),d("ngForOf",t.payments)}}function ee(e,r){if(e&1&&(i(0,"div",6),g(1,Z,9,6,"div",7),a()),e&2){let t=f();o(),d("ngForOf",t.displayedGroups)}}function te(e,r){e&1&&(i(0,"p"),l(1,"There are no payment records."),a())}function ne(e,r){e&1&&(i(0,"p"),l(1,"No payments match your search criteria."),a())}function ie(e,r){if(e&1&&(i(0,"ion-card",19)(1,"ion-card-content",20)(2,"ion-label",15)(3,"h2"),l(4,"No Payments Found"),a(),g(5,te,2,0,"p",21)(6,ne,2,0,"p",21),a()()()),e&2){let t=f();o(5),d("ngIf",!t.searchQuery),o(),d("ngIf",t.searchQuery)}}var ce=(()=>{let r=class r{constructor(m){this.paymentService=m,this.loading$=this.paymentService.loading$,this.displayedGroups=[],this.searchQuery=""}ngOnInit(){this.paymentService.payments$.subscribe(m=>{m&&this.processPayments(m)}),this.paymentService.loadData().catch(m=>{console.error("Error initializing payments:",m)})}processPayments(m){let s=new Map;m.forEach(n=>{let p=new Date(n.date),c=p.toISOString().substring(0,7);s.has(c)||s.set(c,{month:c,formattedDate:p.toLocaleDateString("en-US",{month:"long",year:"numeric"}),payments:[],total:0});let y=s.get(c);y.payments.push(n),y.total+=n.amount}),s.forEach(n=>{n.payments.sort((p,c)=>new Date(c.date).getTime()-new Date(p.date).getTime())}),this.displayedGroups=Array.from(s.values()).sort((n,p)=>p.month.localeCompare(n.month))}onSearchChange(m){var s;this.searchQuery=((s=m.detail.value)==null?void 0:s.toLowerCase())||"",this.paymentService.payments$.subscribe(n=>{if(n){let p=n.filter(c=>{var y;return((y=c.memberName)==null?void 0:y.toLowerCase().includes(this.searchQuery))||c.memberId.toLowerCase().includes(this.searchQuery)||c.paymentType.toLowerCase().includes(this.searchQuery)});this.processPayments(p)}})}showPaymentDetails(m){console.log("Show payment details:",m)}};r.\u0275fac=function(s){return new(s||r)(x(W))},r.\u0275cmp=C({type:r,selectors:[["app-payments-list"]],decls:13,vars:7,consts:[["color","primary"],["slot","start"],["defaultHref","/tabs/payments"],["placeholder","Search payments",3,"ionInput","debounce"],["class","payment-list",4,"ngIf"],["class","no-data-card",4,"ngIf"],[1,"payment-list"],["class","date-group",4,"ngFor","ngForOf"],[1,"date-group"],["sticky","true","color","light"],["slot","end"],["lines","full"],["class","payment-item",3,"click",4,"ngFor","ngForOf"],[1,"payment-item",3,"click"],["color","medium",1,"id-note"],["color","medium"],["color","danger","class","status-badge",4,"ngIf"],["slot","end","color","success",1,"amount-note"],["color","danger",1,"status-badge"],[1,"no-data-card"],[1,"ion-text-center"],[4,"ngIf"]],template:function(s,n){s&1&&(i(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),S(3,"ion-back-button",2),a(),i(4,"ion-title"),l(5,"Payment History"),a()(),i(6,"ion-toolbar")(7,"ion-searchbar",3),v("ionInput",function(c){return n.onSearchChange(c)}),a()()(),i(8,"ion-content"),g(9,ee,2,1,"div",4),u(10,"async"),g(11,ie,7,2,"ion-card",5),u(12,"async"),a()),s&2&&(o(7),d("debounce",500),o(2),d("ngIf",!P(10,3,n.loading$)&&n.displayedGroups.length>0),o(2),d("ngIf",!P(12,5,n.loading$)&&n.displayedGroups.length===0))},dependencies:[$,w,T,L,B,D,H,J,q,G,j,V,U,Q,z,F,K,N,k,R,A],styles:[".payment-list[_ngcontent-%COMP%]{margin-top:1rem}.date-group[_ngcontent-%COMP%]   ion-item-divider[_ngcontent-%COMP%]{--background: var(--ion-color-light);font-weight:500}.payment-item[_ngcontent-%COMP%]   .id-note[_ngcontent-%COMP%]{font-size:.8em;margin-left:.5rem}.payment-item[_ngcontent-%COMP%]   .amount-note[_ngcontent-%COMP%]{font-size:1.1em;font-weight:500}.payment-item[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{margin-left:.5rem;font-size:.7em}.no-data-card[_ngcontent-%COMP%]{margin:1rem;text-align:center}.no-data-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2em;margin-bottom:.5rem}.no-data-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium)}"]});let e=r;return e})();export{ce as PaymentsListPage};
