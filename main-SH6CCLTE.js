import{a as Et,c as kt}from"./chunk-3KRQPOWO.js";import{b as Rt}from"./chunk-K32EJFM3.js";import{a as Ot,b as $t,c as F,d as Dt,e as I,f as zt}from"./chunk-HLDYDQ4G.js";import"./chunk-T47TWMLD.js";import{$a as mt,A as Z,Ac as Pt,C as c,Ca as st,Cc as b,F as tt,Fa as w,Ga as A,Hb as R,I as et,Ia as at,J as it,Jb as ht,Jc as H,Mb as vt,Nb as It,Oa as j,Pb as _t,Qb as Ct,R as ot,Ra as T,S as h,T as m,Tc as Lt,Ua as P,V as S,W as nt,Wa as lt,Wc as Ft,Xb as St,Za as E,_,_a as ct,_b as bt,aa as d,ab as pt,bb as ut,bc as O,cb as k,cc as yt,da as r,db as v,ea as a,ec as $,fa as p,fb as ft,fc as D,gb as dt,gc as xt,gd as Ht,h as J,hb as gt,hc as Mt,ja as rt,k as K,la as g,ld as Nt,ma as M,nd as Bt,r as Q,rc as wt,s as X,sc as At,ud as Ut,v as U,va as f,vc as L,wa as z,wc as jt,x as Y,z as C,zc as Tt}from"./chunk-CCDMTYGH.js";import"./chunk-GRX4ZZSO.js";import"./chunk-7KGURMOZ.js";import"./chunk-Y2YV2HED.js";import"./chunk-EDCKRRWH.js";import"./chunk-SPCCATGZ.js";import"./chunk-YKMIF4NY.js";import"./chunk-YVBCZ55L.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-D5MTWDX2.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{h as B,i as u}from"./chunk-OYAVQN5W.js";var Vt=(()=>{let t=class t{http;prefix;suffix;constructor(i,o="/assets/i18n/",n=".json"){this.http=i,this.prefix=o,this.suffix=n}getTranslation(i){return this.http.get(`${this.prefix}${i}${this.suffix}`)}};B(t,"\u0275fac",function(o){return new(o||t)(c(E),c(String),c(String))}),B(t,"\u0275prov",C({token:t,factory:t.\u0275fac}));let e=t;return e})();var N=(()=>{let t=class t{constructor(i,o){this.authService=i,this.router=o}canActivate(){return this.authService.isReady$.pipe(Q(i=>i),U(1),Y(()=>this.authService.isAuthenticated$.pipe(U(1),K(i=>i?(console.log("User is authenticated, access granted."),!0):(this.router.navigate(["/login"]),console.log("User is not authenticated, redirecting to login page."),!1)))))}};t.\u0275fac=function(o){return new(o||t)(c(I),c(v))},t.\u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var Gt=[{path:"",redirectTo:"tabs",pathMatch:"full"},{path:"login",loadComponent:()=>import("./chunk-T3D6EG2T.js").then(e=>e.LoginPage)},{path:"settings",canActivate:[N],loadComponent:()=>import("./chunk-ZGNWRZE2.js").then(e=>e.SettingsPage)},{path:"attendance/details",canActivate:[N],loadComponent:()=>import("./chunk-MXZNEKTL.js").then(e=>e.AttendanceDetailsPage)},{path:"tabs",canActivate:[N],loadChildren:()=>import("./chunk-36FGLTHI.js").then(e=>e.routes)}];H({peopleOutline:Nt,cashOutline:Ft,calendarOutline:Lt,settingsOutline:Ut});var qt=(()=>{let t=class t{constructor(i,o){this.router=i,this.menu=o}navigate(i){return u(this,null,function*(){yield this.menu.close(),yield this.router.navigate([i])})}};t.\u0275fac=function(o){return new(o||t)(m(v),m(Tt))},t.\u0275cmp=S({type:t,selectors:[["app-menu"]],decls:26,vars:0,consts:[["contentId","main-content"],["color","primary"],["button","","detail","",3,"click"],["slot","start","name","people-outline"],["slot","start","name","cash-outline"],["slot","start","name","calendar-outline"],["slot","start","name","settings-outline"]],template:function(o,n){o&1&&(r(0,"ion-menu",0)(1,"ion-header")(2,"ion-toolbar",1)(3,"ion-title"),f(4,"GymMate"),a()()(),r(5,"ion-content")(6,"ion-list")(7,"ion-item",2),g("click",function(){return n.navigate("/tabs/members")}),p(8,"ion-icon",3),r(9,"ion-label"),f(10,"Members"),a()(),r(11,"ion-item",2),g("click",function(){return n.navigate("/tabs/payments")}),p(12,"ion-icon",4),r(13,"ion-label"),f(14,"Payments"),a()(),r(15,"ion-item",2),g("click",function(){return n.navigate("/tabs/attendance")}),p(16,"ion-icon",5),r(17,"ion-label"),f(18,"Attendance"),a()(),r(19,"ion-item-divider")(20,"ion-label"),f(21,"Admin"),a()(),r(22,"ion-item",2),g("click",function(){return n.navigate("/settings")}),p(23,"ion-icon",6),r(24,"ion-label"),f(25,"Settings"),a()()()()())},dependencies:[Mt,bt,At,wt,St,D,O,b,$,yt],encapsulation:2});let e=t;return e})();var Wt=(()=>{let t=class t{constructor(i,o,n){this.toastController=i,this.router=o,this.authService=n}intercept(i,o){return o.handle(i).pipe(X(n=>{var x,W;let s="An error occurred";return n.error instanceof ErrorEvent?s=`Error: ${n.error.message}`:n.status===401?(this.authService.logout(),this.router.navigate(["/login"]),s="Session expired. Please log in again."):(W=(x=n.error)==null?void 0:x.error)!=null&&W.message?s=n.error.error.message:s=`Error Code: ${n.status}
Message: ${n.message}`,this.presentErrorToast(s),J(()=>n)}))}presentErrorToast(i){return u(this,null,function*(){yield(yield this.toastController.create({message:i,duration:3e3,position:"bottom",color:"danger",buttons:[{text:"Dismiss",role:"cancel"}]})).present()})}};t.\u0275fac=function(o){return new(o||t)(c(Pt),c(v),c(I))},t.\u0275prov=C({token:t,factory:t.\u0275fac});let e=t;return e})();function Yt(e,t){if(e&1&&(r(0,"ion-item")(1,"ion-label")(2,"h2"),f(3),a(),r(4,"p"),f(5),a()()()),e&2){let l=t.ngIf;h(3),z(l.name),h(2),z(l.email)}}var Jt=(()=>{let t=class t{constructor(i,o){this.authService=i,this.popoverController=o,this.userSession$=this.authService.userSession$}logout(){this.popoverController.dismiss(null,"logout")}};t.\u0275fac=function(o){return new(o||t)(m(I),m(L))},t.\u0275cmp=S({type:t,selectors:[["app-profile-menu"]],decls:7,vars:3,consts:[[4,"ngIf"],["button","",3,"click"],["slot","start","name","log-out-outline"]],template:function(o,n){o&1&&(r(0,"ion-list"),_(1,Yt,6,2,"ion-item",0),w(2,"async"),r(3,"ion-item",1),g("click",function(){return n.logout()}),p(4,"ion-icon",2),r(5,"ion-label"),f(6,"Logout"),a()()()),o&2&&(h(),d("ngIf",A(2,1,n.userSession$)))},dependencies:[P,j,T,D,O,$,b],styles:["ion-list[_ngcontent-%COMP%]{margin:0;padding:0}h2[_ngcontent-%COMP%]{font-weight:500;margin:0}p[_ngcontent-%COMP%]{margin:4px 0 0;color:var(--ion-color-medium)}"]});let e=t;return e})();function Zt(e,t){if(e&1&&p(0,"ion-loading",3),e&2){let l=M();d("isOpen",l.loading)}}function te(e,t){if(e&1&&p(0,"img",10),e&2){let l=M().ngIf;d("src",l.picture,ot)}}function ee(e,t){e&1&&p(0,"ion-icon",11)}function ie(e,t){if(e&1){let l=rt();r(0,"ion-buttons",5)(1,"ion-button",6),g("click",function(o){et(l);let n=M(2);return it(n.showProfileMenu(o))}),r(2,"ion-avatar",7),_(3,te,1,1,"img",8)(4,ee,1,0,"ion-icon",9),a()()()}if(e&2){let l=t.ngIf;h(3),d("ngIf",l.picture),h(),d("ngIf",!l.picture)}}function oe(e,t){if(e&1&&(_(0,ie,5,2,"ion-buttons",4),w(1,"async")),e&2){let l=M();d("ngIf",A(1,1,l.userSession$))}}var Kt=(()=>{let t=class t{constructor(i,o,n,s,x){this.authService=i,this.router=o,this.popoverController=n,this.route=s,this.clubContext=x,this.loading=!1,H({personCircleOutline:Bt,logOutOutline:Ht}),this.userSession$=this.authService.userSession$}ngOnInit(){return u(this,null,function*(){try{yield $t.initialize({google:{webClientId:Ot.googleSignInClientId}})}catch(i){console.error("Failed to initialize Social Login:",i)}yield this.authService.loadSession().catch(i=>{console.error("Error loading session on app init:",i)}),this.authService.isAuthenticated$.subscribe(i=>u(this,null,function*(){if(i){let o=this.router.url;this.route.queryParams.subscribe(n=>u(this,null,function*(){let s=n.sportsClubId;s&&this.clubContext.setSportsClubId(s),!this.clubContext.getSportsClubId()&&!o.includes("/settings")?yield this.router.navigate(["/settings"]):console.log("Active session found, refreshing all data")}))}}))})}showProfileMenu(i){return u(this,null,function*(){let o=yield this.popoverController.create({component:Jt,event:i,translucent:!0});yield o.present();let{role:n}=yield o.onWillDismiss();n==="logout"&&(yield this.authService.logout(),yield this.router.navigate(["/login"]))})}};t.\u0275fac=function(o){return new(o||t)(m(I),m(v),m(L),m(ut),m(zt))},t.\u0275cmp=S({type:t,selectors:[["app-root"]],features:[st([{provide:k,useClass:R},{provide:ct,useClass:Wt,multi:!0}])],decls:6,vars:1,consts:[["userProfile",""],["id","main-content"],["message","Refreshing data...","spinner","crescent","backdropDismiss","false",3,"isOpen",4,"ngIf"],["message","Refreshing data...","spinner","crescent","backdropDismiss","false",3,"isOpen"],["slot","end",4,"ngIf"],["slot","end"],[3,"click"],["slot","icon-only"],[3,"src",4,"ngIf"],["name","person-circle-outline",4,"ngIf"],[3,"src"],["name","person-circle-outline"]],template:function(o,n){o&1&&(r(0,"ion-app"),p(1,"app-menu")(2,"ion-router-outlet",1),_(3,Zt,1,1,"ion-loading",2),a(),_(4,oe,2,3,"ng-template",null,0,at)),o&2&&(h(3),d("ngIf",n.loading))},dependencies:[P,j,T,vt,ht,It,b,_t,Ct,pt,qt,xt],encapsulation:2});let e=t;return e})();var Qt=(()=>{let t=class t{constructor(i){this.storage=i,this.init()}init(){return u(this,null,function*(){yield this.storage.create()})}};t.\u0275fac=function(o){return new(o||t)(c(F))},t.\u0275mod=nt({type:t}),t.\u0275inj=Z({providers:[F],imports:[Dt.forRoot({name:"playmate_db",driverOrder:["indexeddb","localstorage"]})]});let e=t;return e})();function ne(e){return new Vt(e,"./assets/i18n/",".json")}lt(Kt,{providers:[{provide:k,useClass:R},jt(),dt(Gt,gt(ft)),mt(),Rt(),tt(Qt,kt.forRoot({loader:{provide:Et,useFactory:ne,deps:[E]},defaultLanguage:"en"}))]});export{ne as createTranslateLoader};
