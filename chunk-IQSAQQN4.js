import{a as pe}from"./chunk-7VAS3SO6.js";import"./chunk-FXU2RMGT.js";import{a as de}from"./chunk-6TKSE3PE.js";import"./chunk-WKSYTGLY.js";import"./chunk-IG6JAMQW.js";import"./chunk-T47TWMLD.js";import"./chunk-35HGTZOU.js";import{$ as p,Aa as D,Bc as ae,Dc as se,Ea as u,Ec as re,Fa as E,Ga as h,H as x,Ha as B,I as S,Ic as me,Jb as H,Ma as k,Na as V,Nb as U,Ob as W,Pb as j,Qa as F,Qb as K,R as o,Ra as $,Rb as R,S as I,Sa as N,Ta as G,U as w,Wb as q,Z as _,Zb as J,_c as le,ac as X,bc as Y,ca as n,da as i,dc as Z,ea as C,ec as ee,ia as P,ic as te,jb as Q,jc as ne,ka as b,la as g,mb as z,qc as ie,rb as A,rc as oe,rd as ce,ta as M,ua as c,va as v,wa as y,xa as O,ya as T,za as L}from"./chunk-AAX3YNDZ.js";import"./chunk-GRX4ZZSO.js";import"./chunk-7KGURMOZ.js";import"./chunk-Y2YV2HED.js";import"./chunk-EDCKRRWH.js";import"./chunk-SPCCATGZ.js";import"./chunk-YKMIF4NY.js";import"./chunk-YVBCZ55L.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-D5MTWDX2.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import"./chunk-OYAVQN5W.js";function _e(e,r){if(e&1){let t=P();n(0,"ion-button",10),b("click",function(){x(t);let s=g();return S(s.toggleSearch())}),C(1,"ion-icon",11),i()}if(e&2){let t=g();o(),p("name",t.isSearchVisible?"close-outline":"search-outline")}}function ge(e,r){if(e&1){let t=P();n(0,"ion-toolbar")(1,"ion-searchbar",12),b("ionInput",function(s){x(t);let a=g();return S(a.onSearchChange(s))}),i()()}e&2&&(o(),p("debounce",500))}function ue(e,r){if(e&1&&(n(0,"ion-badge",26),c(1),i()),e&2){let t=g().$implicit;o(),y(" ",t.status," ")}}function fe(e,r){if(e&1){let t=P();n(0,"ion-item",21),b("click",function(){let s=x(t).$implicit,a=g(4);return S(a.showPaymentDetails(s))}),n(1,"ion-label")(2,"h2"),c(3),n(4,"ion-note",22),c(5),i()(),n(6,"ion-note",23),c(7),u(8,"date"),_(9,ue,2,1,"ion-badge",24),i()(),n(10,"ion-note",25),c(11),u(12,"number"),i()()}if(e&2){let t=r.$implicit;o(3),y("",t.memberName||"Unknown Member"," "),o(2),y("#",t.memberId,""),o(2),O(" ",h(8,6,t.date,"mediumDate")," \xB7 ",t.paymentType," "),o(2),p("ngIf",t.status!=="active"),o(2),y(" \u20B9",h(12,9,t.amount,"1.0-0")," ")}}function ye(e,r){if(e&1&&(n(0,"div",17)(1,"ion-item-divider",18)(2,"ion-label"),c(3),i(),n(4,"ion-note",4),c(5),u(6,"number"),i()(),n(7,"ion-list",19),_(8,fe,13,12,"ion-item",20),i()()),e&2){let t=r.$implicit;o(3),v(t.formattedDate),o(2),y("\u20B9",h(6,3,t.total,"1.0-0"),""),o(3),p("ngForOf",t.payments)}}function he(e,r){if(e&1&&(n(0,"div",15),_(1,ye,9,6,"div",16),i()),e&2){let t=g(2);o(),p("ngForOf",t.displayedGroups)}}function ve(e,r){e&1&&(n(0,"p"),c(1,"There are no payment records."),i())}function xe(e,r){e&1&&(n(0,"p"),c(1,"No payments match your search criteria."),i())}function Se(e,r){if(e&1&&(n(0,"ion-card",27)(1,"ion-card-content",28)(2,"ion-label",23)(3,"h2"),c(4,"No Payments Found"),i(),_(5,ve,2,0,"p",9)(6,xe,2,0,"p",9),i()()()),e&2){let t=g(2);o(5),p("ngIf",!t.searchQuery),o(),p("ngIf",t.searchQuery)}}function Pe(e,r){if(e&1&&(n(0,"div"),_(1,he,2,1,"div",13),u(2,"async"),_(3,Se,7,2,"ion-card",14),u(4,"async"),i()),e&2){let t=g();o(),p("ngIf",!E(2,2,t.loading$)&&t.displayedGroups.length>0),o(2),p("ngIf",!E(4,4,t.loading$)&&t.displayedGroups.length===0)}}function be(e,r){if(e&1&&(n(0,"h2"),c(1),i()),e&2){let t=g().$implicit;o(),v(t.notes)}}function Ie(e,r){if(e&1&&(n(0,"ion-item",32)(1,"ion-label"),_(2,be,2,1,"h2",9),n(3,"p"),c(4),i(),n(5,"p"),c(6),u(7,"date"),i()(),n(8,"ion-note",33),c(9),u(10,"number"),i()()),e&2){let t=r.$implicit;o(2),p("ngIf",t.notes),o(2),v(t.category),o(2),v(h(7,4,t.date,"mediumDate")),o(3),y(" \u20B9",h(10,7,t.amount,"1.2-2")," ")}}function Ce(e,r){if(e&1&&(n(0,"div",17)(1,"ion-item-divider",18)(2,"ion-label"),c(3),i(),n(4,"ion-note",4),c(5),u(6,"number"),i()(),n(7,"ion-list",19),_(8,Ie,11,10,"ion-item",31),i()()),e&2){let t=r.$implicit;o(3),v(t.formattedDate),o(2),y("-\u20B9",h(6,3,t.total,"1.0-0"),""),o(3),p("ngForOf",t.expenses)}}function Ee(e,r){if(e&1&&(n(0,"div",30),_(1,Ce,9,6,"div",16),i()),e&2){let t=g(2);o(),p("ngForOf",t.expenseGroups)}}function we(e,r){e&1&&(n(0,"ion-item")(1,"ion-label"),c(2,"No expenses found."),i()())}function Me(e,r){if(e&1&&(n(0,"div"),_(1,Ee,2,1,"div",29)(2,we,3,0,"ng-template",null,0,B),i()),e&2){let t=M(3),m=g();o(),p("ngIf",m.expenseGroups.length>0)("ngIfElse",t)}}var Ge=(()=>{let r=class r{constructor(m,s){this.paymentService=m,this.expenseService=s,this.loading$=this.paymentService.loading$,this.displayedGroups=[],this.searchQuery="",this.selectedSegment="payments",this.expenses=[],this.expenseGroups=[],this.isSearchVisible=!1}ngOnInit(){this.paymentService.payments$.subscribe(m=>{m&&this.processPayments(m)}),this.expenseService.expenses$.subscribe(m=>{this.expenses=m,this.processExpenses(m)}),this.expenseService.loadData(),me({searchOutline:ce,closeOutline:le})}processPayments(m){let s=new Map;m.forEach(a=>{let d=new Date(a.date),l=d.toISOString().substring(0,7);s.has(l)||s.set(l,{month:l,formattedDate:d.toLocaleDateString("en-US",{month:"long",year:"numeric"}),payments:[],total:0});let f=s.get(l);f.payments.push(a),f.total+=a.amount}),s.forEach(a=>{a.payments.sort((d,l)=>new Date(l.date).getTime()-new Date(d.date).getTime())}),this.displayedGroups=Array.from(s.values()).sort((a,d)=>d.month.localeCompare(a.month))}processExpenses(m){let s=new Map;m.forEach(a=>{let d=new Date(a.date),l=d.toISOString().substring(0,7);s.has(l)||s.set(l,{month:l,formattedDate:d.toLocaleDateString("en-US",{month:"long",year:"numeric"}),expenses:[],total:0});let f=s.get(l);f.expenses.push(a),f.total+=a.amount}),s.forEach(a=>{a.expenses.sort((d,l)=>new Date(l.date).getTime()-new Date(d.date).getTime())}),this.expenseGroups=Array.from(s.values()).sort((a,d)=>d.month.localeCompare(a.month))}onSearchChange(m){var s;this.searchQuery=((s=m.detail.value)==null?void 0:s.toLowerCase())||"",this.paymentService.payments$.subscribe(a=>{if(a){let d=a.filter(l=>{var f;return((f=l.memberName)==null?void 0:f.toLowerCase().includes(this.searchQuery))||l.memberId.toLowerCase().includes(this.searchQuery)||l.paymentType.toLowerCase().includes(this.searchQuery)});this.processPayments(d)}})}showPaymentDetails(m){console.log("Show payment details:",m)}toggleSearch(){this.isSearchVisible=!this.isSearchVisible,this.isSearchVisible||(this.searchQuery="",this.paymentService.payments$.subscribe(m=>{m&&this.processPayments(m)}))}};r.\u0275fac=function(s){return new(s||r)(I(de),I(pe))},r.\u0275cmp=w({type:r,selectors:[["app-payments-list"]],decls:20,vars:5,consts:[["noExpenses",""],["color","primary"],["slot","start"],["defaultHref","/tabs/payments"],["slot","end"],[3,"click",4,"ngIf"],["mode","ios",1,"payments-segment",3,"ngModelChange","ngModel"],["value","payments"],["value","expenses"],[4,"ngIf"],[3,"click"],["slot","icon-only",3,"name"],["placeholder","Search payments",3,"ionInput","debounce"],["class","payment-list",4,"ngIf"],["class","no-data-card",4,"ngIf"],[1,"payment-list"],["class","date-group",4,"ngFor","ngForOf"],[1,"date-group"],["sticky","true","color","light"],["lines","full"],["class","payment-item",3,"click",4,"ngFor","ngForOf"],[1,"payment-item",3,"click"],["color","medium",1,"id-note"],["color","medium"],["color","danger","class","status-badge",4,"ngIf"],["slot","end","color","success",1,"amount-note"],["color","danger",1,"status-badge"],[1,"no-data-card"],[1,"ion-text-center"],["class","expense-list",4,"ngIf","ngIfElse"],[1,"expense-list"],["class","expense-item",4,"ngFor","ngForOf"],[1,"expense-item"],["slot","end","color","danger",1,"amount-note"]],template:function(s,a){s&1&&(n(0,"ion-header")(1,"ion-toolbar",1)(2,"ion-buttons",2),C(3,"ion-back-button",3),i(),n(4,"ion-title"),c(5,"Payment History"),i(),n(6,"ion-buttons",4),_(7,_e,2,1,"ion-button",5),i()(),n(8,"ion-toolbar")(9,"ion-segment",6),D("ngModelChange",function(l){return L(a.selectedSegment,l)||(a.selectedSegment=l),l}),n(10,"ion-segment-button",7)(11,"ion-label"),c(12,"Payments"),i()(),n(13,"ion-segment-button",8)(14,"ion-label"),c(15,"Expenses"),i()()()(),_(16,ge,2,1,"ion-toolbar",9),i(),n(17,"ion-content"),_(18,Pe,5,6,"div",9)(19,Me,4,2,"div",9),i()),s&2&&(o(7),p("ngIf",a.selectedSegment==="payments"),o(2),T("ngModel",a.selectedSegment),o(7),p("ngIf",a.isSearchVisible&&a.selectedSegment==="payments"),o(2),p("ngIf",a.selectedSegment==="payments"),o(),p("ngIf",a.selectedSegment==="expenses"))},dependencies:[G,k,V,F,N,$,A,Q,z,J,oe,ie,q,ee,X,Z,K,R,U,te,j,H,se,Y,re,ne,ae,W],styles:[".payment-list[_ngcontent-%COMP%]{margin-top:1rem}.date-group[_ngcontent-%COMP%]   ion-item-divider[_ngcontent-%COMP%]{--background: var(--ion-color-light);font-weight:500}.payment-item[_ngcontent-%COMP%]   .id-note[_ngcontent-%COMP%]{font-size:.8em;margin-left:.5rem}.payment-item[_ngcontent-%COMP%]   .amount-note[_ngcontent-%COMP%]{font-size:1.1em;font-weight:500}.payment-item[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{margin-left:.5rem;font-size:.7em}.no-data-card[_ngcontent-%COMP%]{margin:1rem;text-align:center}.no-data-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2em;margin-bottom:.5rem}.no-data-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium)}.expense-item[_ngcontent-%COMP%]   .amount-note[_ngcontent-%COMP%]{font-size:1.1em;font-weight:500}ion-segment-button.segment-button-checked[_ngcontent-%COMP%], ion-segment-button.segment-button-checked[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:#000!important;--color: #000 !important}"]});let e=r;return e})();export{Ge as PaymentsListPage};
