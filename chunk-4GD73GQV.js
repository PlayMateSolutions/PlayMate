import{A as S,D as E,M as X,d as L,f as C,g as F,h as R,i as P,j as $,m as q,n as v,o as M,p as N,r as c,s as J,t as b,u as l}from"./chunk-R775EV27.js";import{a as V,h as o}from"./chunk-OYAVQN5W.js";var d=class{},z=(()=>{let n=class n extends d{getTranslation(e){return L({})}};o(n,"\u0275fac",(()=>{let e;return function(i){return(e||(e=S(n)))(i||n)}})()),o(n,"\u0275prov",c({token:n,factory:n.\u0275fac}));let s=n;return s})(),D=class{},W=(()=>{let n=class n{handle(e){return e.key}};o(n,"\u0275fac",function(t){return new(t||n)}),o(n,"\u0275prov",c({token:n,factory:n.\u0275fac}));let s=n;return s})();function f(s){return typeof s<"u"&&s!==null}function A(s){return j(s)&&!H(s)&&s!==null}function j(s){return typeof s=="object"}function H(s){return Array.isArray(s)}function k(s){return typeof s=="string"}function ee(s){return typeof s=="function"}function K(s,n){let u=Object.assign({},s);return j(s)?(j(s)&&j(n)&&Object.keys(n).forEach(e=>{A(n[e])?e in s?u[e]=K(s[e],n[e]):Object.assign(u,{[e]:n[e]}):Object.assign(u,{[e]:n[e]})}),u):K({},n)}function x(s,n){let u=n.split(".");n="";do n+=u.shift(),f(s)&&f(s[n])&&(A(s[n])||H(s[n])||!u.length)?(s=s[n],n=""):u.length?n+=".":s=void 0;while(u.length);return s}function te(s,n,u){let e=n.split("."),t=s;for(let i=0;i<e.length;i++){let a=e[i];i===e.length-1?t[a]=u:((!t[a]||!A(t[a]))&&(t[a]={}),t=t[a])}}var g=class{},Z=(()=>{let n=class n extends g{templateMatcher=/{{\s?([^{}\s]*)\s?}}/g;interpolate(e,t){if(k(e))return this.interpolateString(e,t);if(ee(e))return this.interpolateFunction(e,t)}interpolateFunction(e,t){return e(t)}interpolateString(e,t){return t?e.replace(this.templateMatcher,(i,a)=>{let r=x(t,a);return f(r)?r:i}):e}};o(n,"\u0275fac",(()=>{let e;return function(i){return(e||(e=S(n)))(i||n)}})()),o(n,"\u0275prov",c({token:n,factory:n.\u0275fac}));let s=n;return s})(),p=class{},Q=(()=>{let n=class n extends p{compile(e,t){return e}compileTranslations(e,t){return e}};o(n,"\u0275fac",(()=>{let e;return function(i){return(e||(e=S(n)))(i||n)}})()),o(n,"\u0275prov",c({token:n,factory:n.\u0275fac}));let s=n;return s})(),T=class{defaultLang;currentLang=this.defaultLang;translations={};langs=[];onTranslationChange=new E;onLangChange=new E;onDefaultLangChange=new E},O=new b("ISOLATE_TRANSLATE_SERVICE"),U=new b("USE_DEFAULT_LANG"),B=new b("DEFAULT_LANGUAGE"),G=new b("USE_EXTEND"),m=s=>C(s)?s:L(s),Y=(()=>{let n=class n{store;currentLoader;compiler;parser;missingTranslationHandler;useDefaultLang;extend;loadingTranslations;pending=!1;_translationRequests={};lastUseLanguage=null;get onTranslationChange(){return this.store.onTranslationChange}get onLangChange(){return this.store.onLangChange}get onDefaultLangChange(){return this.store.onDefaultLangChange}get defaultLang(){return this.store.defaultLang}set defaultLang(e){this.store.defaultLang=e}get currentLang(){return this.store.currentLang}set currentLang(e){this.store.currentLang=e}get langs(){return this.store.langs}set langs(e){this.store.langs=e}get translations(){return this.store.translations}set translations(e){this.store.translations=e}constructor(e,t,i,a,r,I=!0,h=!1,y=!1,w){this.store=e,this.currentLoader=t,this.compiler=i,this.parser=a,this.missingTranslationHandler=r,this.useDefaultLang=I,this.extend=y,h&&(this.store=new T),w&&this.setDefaultLang(w)}setDefaultLang(e){if(e===this.defaultLang)return;let t=this.retrieveTranslations(e);typeof t<"u"?(this.defaultLang==null&&(this.defaultLang=e),t.pipe(v(1)).subscribe(()=>{this.changeDefaultLang(e)})):this.changeDefaultLang(e)}getDefaultLang(){return this.defaultLang}use(e){if(this.lastUseLanguage=e,e===this.currentLang)return L(this.translations[e]);this.currentLang||(this.currentLang=e);let t=this.retrieveTranslations(e);return C(t)?(t.pipe(v(1)).subscribe(()=>{this.changeLang(e)}),t):(this.changeLang(e),L(this.translations[e]))}changeLang(e){e===this.lastUseLanguage&&(this.currentLang=e,this.onLangChange.emit({lang:e,translations:this.translations[e]}),this.defaultLang==null&&this.changeDefaultLang(e))}retrieveTranslations(e){if(typeof this.translations[e]>"u"||this.extend)return this._translationRequests[e]=this._translationRequests[e]||this.loadAndCompileTranslations(e),this._translationRequests[e]}getTranslation(e){return this.loadAndCompileTranslations(e)}loadAndCompileTranslations(e){this.pending=!0;let t=this.currentLoader.getTranslation(e).pipe(M(1),v(1));return this.loadingTranslations=t.pipe(F(i=>this.compiler.compileTranslations(i,e)),M(1),v(1)),this.loadingTranslations.subscribe({next:i=>{this.translations[e]=this.extend&&this.translations[e]?V(V({},i),this.translations[e]):i,this.updateLangs(),this.pending=!1},error:i=>{this.pending=!1}}),t}setTranslation(e,t,i=!1){let a=this.compiler.compileTranslations(t,e);(i||this.extend)&&this.translations[e]?this.translations[e]=K(this.translations[e],a):this.translations[e]=a,this.updateLangs(),this.onTranslationChange.emit({lang:e,translations:this.translations[e]})}getLangs(){return this.langs}addLangs(e){let t=e.filter(i=>!this.langs.includes(i));t.length>0&&(this.langs=[...this.langs,...t])}updateLangs(){this.addLangs(Object.keys(this.translations))}getParsedResultForKey(e,t,i){let a;if(e&&(a=this.runInterpolation(x(e,t),i)),a===void 0&&this.defaultLang!=null&&this.defaultLang!==this.currentLang&&this.useDefaultLang&&(a=this.runInterpolation(x(this.translations[this.defaultLang],t),i)),a===void 0){let r={key:t,translateService:this};typeof i<"u"&&(r.interpolateParams=i),a=this.missingTranslationHandler.handle(r)}return a!==void 0?a:t}runInterpolation(e,t){if(H(e))return e.map(i=>this.runInterpolation(i,t));if(A(e)){let i={};for(let a in e){let r=this.runInterpolation(e[a],t);r!==void 0&&(i[a]=r)}return i}else return this.parser.interpolate(e,t)}getParsedResult(e,t,i){if(t instanceof Array){let a={},r=!1;for(let h of t)a[h]=this.getParsedResultForKey(e,h,i),r=r||C(a[h]);if(!r)return a;let I=t.map(h=>m(a[h]));return $(I).pipe(F(h=>{let y={};return h.forEach((w,_)=>{y[t[_]]=w}),y}))}return this.getParsedResultForKey(e,t,i)}get(e,t){if(!f(e)||!e.length)throw new Error('Parameter "key" is required and cannot be empty');return this.pending?this.loadingTranslations.pipe(q(i=>m(this.getParsedResult(i,e,t)))):m(this.getParsedResult(this.translations[this.currentLang],e,t))}getStreamOnTranslationChange(e,t){if(!f(e)||!e.length)throw new Error('Parameter "key" is required and cannot be empty');return R(P(()=>this.get(e,t)),this.onTranslationChange.pipe(N(i=>{let a=this.getParsedResult(i.translations,e,t);return m(a)})))}stream(e,t){if(!f(e)||!e.length)throw new Error('Parameter "key" required');return R(P(()=>this.get(e,t)),this.onLangChange.pipe(N(i=>{let a=this.getParsedResult(i.translations,e,t);return m(a)})))}instant(e,t){if(!f(e)||e.length===0)throw new Error('Parameter "key" is required and cannot be empty');let i=this.getParsedResult(this.translations[this.currentLang],e,t);return C(i)?Array.isArray(e)?e.reduce((a,r)=>(a[r]=r,a),{}):e:i}set(e,t,i=this.currentLang){te(this.translations[i],e,k(t)?this.compiler.compile(t,i):this.compiler.compileTranslations(t,i)),this.updateLangs(),this.onTranslationChange.emit({lang:i,translations:this.translations[i]})}changeDefaultLang(e){this.defaultLang=e,this.onDefaultLangChange.emit({lang:e,translations:this.translations[e]})}reloadLang(e){return this.resetLang(e),this.loadAndCompileTranslations(e)}resetLang(e){delete this._translationRequests[e],delete this.translations[e]}getBrowserLang(){if(typeof window>"u"||!window.navigator)return;let e=this.getBrowserCultureLang();return e?e.split(/[-_]/)[0]:void 0}getBrowserCultureLang(){if(!(typeof window>"u"||typeof window.navigator>"u"))return window.navigator.languages?window.navigator.languages[0]:window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage}};o(n,"\u0275fac",function(t){return new(t||n)(l(T),l(d),l(p),l(g),l(D),l(U),l(O),l(G),l(B))}),o(n,"\u0275prov",c({token:n,factory:n.\u0275fac,providedIn:"root"}));let s=n;return s})();var ve=(()=>{let n=class n{static forRoot(e={}){return{ngModule:n,providers:[e.loader||{provide:d,useClass:z},e.compiler||{provide:p,useClass:Q},e.parser||{provide:g,useClass:Z},e.missingTranslationHandler||{provide:D,useClass:W},T,{provide:O,useValue:e.isolate},{provide:U,useValue:e.useDefaultLang},{provide:G,useValue:e.extend},{provide:B,useValue:e.defaultLanguage},Y]}}static forChild(e={}){return{ngModule:n,providers:[e.loader||{provide:d,useClass:z},e.compiler||{provide:p,useClass:Q},e.parser||{provide:g,useClass:Z},e.missingTranslationHandler||{provide:D,useClass:W},{provide:O,useValue:e.isolate},{provide:U,useValue:e.useDefaultLang},{provide:G,useValue:e.extend},{provide:B,useValue:e.defaultLanguage},Y]}}};o(n,"\u0275fac",function(t){return new(t||n)}),o(n,"\u0275mod",X({type:n})),o(n,"\u0275inj",J({}));let s=n;return s})();export{d as a,Y as b,ve as c};
