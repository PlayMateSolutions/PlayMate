import{a as ue}from"./chunk-AXP7R7SC.js";import{e as ae,f as le}from"./chunk-J5NWP6QB.js";import"./chunk-T47TWMLD.js";import{a as ce}from"./chunk-35HGTZOU.js";import{$ as h,Aa as M,Bc as te,Cc as ie,Fc as ne,H as d,Ha as V,Hc as oe,I as g,Ic as re,Mb as U,Na as L,Ob as O,Pb as F,Q as x,R as u,S as p,Ta as B,U as P,Wb as G,Z as b,Zb as H,ac as R,bc as z,ca as t,cb as A,cc as q,da as i,dc as J,ea as S,ec as K,fa as k,ga as T,hc as Q,ia as v,ic as X,jb as N,ka as f,kc as Y,la as I,mb as W,pd as se,qc as Z,rb as j,rc as $,ta as D,ua as o,va as w,ya as y,za as E,zc as ee}from"./chunk-TS5MQKIE.js";import"./chunk-GRX4ZZSO.js";import"./chunk-7KGURMOZ.js";import"./chunk-Y2YV2HED.js";import"./chunk-EDCKRRWH.js";import"./chunk-SPCCATGZ.js";import"./chunk-YKMIF4NY.js";import"./chunk-YVBCZ55L.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-D5MTWDX2.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{i as _}from"./chunk-OYAVQN5W.js";function de(s,l){s&1&&(k(0),S(1,"ion-spinner",15),T())}function ge(s,l){if(s&1){let C=v();t(0,"ion-button",16),f("click",function(){d(C);let a=I();return g(a.saveSettings())}),S(1,"ion-icon",17),i()}if(s&2){let C=I();h("disabled",!C.hasChanges)}}function me(s,l){if(s&1&&(t(0,"ion-avatar",2),S(1,"img",18),i()),s&2){let C=I();u(),h("src",C.userPicture,x)}}var Pe=(()=>{let l=class l{constructor(n,a,e,r,m){this.clubContext=n,this.toastCtrl=a,this.router=e,this.authService=r,this.apiService=m,this.sportsClubId="",this.hasChanges=!1,this.loading=!1,this.darkMode=!1,this.language="en",this.userEmail="",this.userName="",this.userPicture="",this.darkMode=document.body.classList.contains("dark-theme"),this.language=localStorage.getItem("language")||"en"}ngOnInit(){let n=this.clubContext.getSportsClubId();this.sportsClubId=n||"",this.loadUserInfo(),re({saveOutline:se})}loadUserInfo(){this.authService.userSession$.subscribe(n=>{n&&(this.userEmail=n.email,this.userName=n.name,this.userPicture=n.picture||"")})}settingsChanged(){this.hasChanges=!0}saveSettings(){return _(this,null,function*(){this.loading=!0;let n=this.sportsClubId.trim(),a=this.clubContext.getSportsClubId()||"";if(n)if(n!==a)try{let e=yield this.apiService.get("getSportsClubById",n);console.log("Club ID validation response:",e),e.status==="success"&&e.data&&e.data.active?(this.clubContext.setSportsClubId(n),yield(yield this.toastCtrl.create({message:"Settings saved successfully!",duration:1500,color:"success"})).present(),this.hasChanges=!1):yield(yield this.toastCtrl.create({message:"Invalid or inactive Sports Club ID.",duration:1500,color:"danger"})).present()}catch(e){console.error("Error validating club ID:",e),yield(yield this.toastCtrl.create({message:"Failed to validate Sports Club ID. Please try again.",duration:1500,color:"danger"})).present()}finally{this.loading=!1}else this.clubContext.setSportsClubId(n),yield(yield this.toastCtrl.create({message:"Settings saved successfully!",duration:1500,color:"success"})).present(),this.hasChanges=!1,this.loading=!1;else(yield this.toastCtrl.create({message:"Please enter a valid Sports Club ID.",duration:1500,color:"danger"})).present(),this.loading=!1})}toggleDarkMode(){document.body.classList.toggle("dark-theme",this.darkMode),this.clubContext.setDarkMode(this.darkMode)}changeLanguage(){this.clubContext.setLanguage(this.language)}logout(){return _(this,null,function*(){if(window.confirm("Are you sure you want to logout? This will delete all your local PlayMate data."))try{yield this.authService.logout();try{yield ce.deleteDatabase(),console.log("PlayMateDB deleted successfully")}catch(a){console.error("Error deleting PlayMateDB:",a)}this.clubContext.clear(),yield this.router.navigate(["/login"],{replaceUrl:!0})}catch(a){console.error("Logout error:",a),yield(yield this.toastCtrl.create({message:"Error during logout. Please try again.",duration:2e3,color:"danger"})).present()}})}};l.\u0275fac=function(a){return new(a||l)(p(le),p(ee),p(A),p(ae),p(ue))},l.\u0275cmp=P({type:l,selectors:[["app-settings"]],decls:63,vars:8,consts:[["saveBtn",""],["color","primary"],["slot","start"],["slot","end"],[4,"ngIf","ngIfElse"],[1,"ion-padding"],["position","stacked"],["placeholder","Enter Sports Club ID","type","text",3,"ionInput","value"],[3,"ngModelChange","ionChange","ngModel"],["value","en"],["value","ta"],["lines","none"],["slot","start",4,"ngIf"],["slot","end","fill","clear","color","danger",3,"click"],["slot","start","name","log-out-outline"],["name","circular"],[3,"click","disabled"],["slot","start","name","save-outline"],["alt","Profile Picture",3,"src"]],template:function(a,e){if(a&1){let r=v();t(0,"ion-header")(1,"ion-toolbar",1)(2,"ion-buttons",2),S(3,"ion-menu-button"),i(),t(4,"ion-title"),o(5,"Settings"),i(),t(6,"ion-buttons",3),b(7,de,2,0,"ng-container",4)(8,ge,2,1,"ng-template",null,0,V),i()()(),t(10,"ion-content",5)(11,"ion-list")(12,"ion-item-group")(13,"ion-item-divider")(14,"ion-label"),o(15,"Club Settings"),i()(),t(16,"ion-item")(17,"ion-label",6),o(18,"Sports Club ID"),i(),t(19,"ion-input",7),f("ionInput",function(c){return d(r),e.sportsClubId=c.target.value,g(e.settingsChanged())}),i(),t(20,"ion-note"),o(21,"This ID is used to identify your club in the system"),i()()(),t(22,"ion-item-group")(23,"ion-item-divider")(24,"ion-label"),o(25,"App Settings"),i()(),t(26,"ion-item")(27,"ion-label"),o(28,"Dark Mode"),i(),t(29,"ion-toggle",8),M("ngModelChange",function(c){return d(r),E(e.darkMode,c)||(e.darkMode=c),g(c)}),f("ionChange",function(){return d(r),g(e.toggleDarkMode())}),i()(),t(30,"ion-item")(31,"ion-label"),o(32,"Language"),i(),t(33,"ion-select",8),M("ngModelChange",function(c){return d(r),E(e.language,c)||(e.language=c),g(c)}),f("ionChange",function(){return d(r),g(e.changeLanguage())}),t(34,"ion-select-option",9),o(35,"English"),i(),t(36,"ion-select-option",10),o(37,"Tamil"),i()()()(),t(38,"ion-item-group")(39,"ion-item-divider")(40,"ion-label"),o(41,"Account"),i()(),t(42,"ion-item",11),b(43,me,2,1,"ion-avatar",12),t(44,"ion-label")(45,"h2"),o(46),i(),t(47,"p"),o(48),i(),t(49,"p"),o(50,"Google Account"),i()(),t(51,"ion-button",13),f("click",function(){return d(r),g(e.logout())}),S(52,"ion-icon",14),o(53," Logout "),i()()(),t(54,"ion-item-group")(55,"ion-item-divider")(56,"ion-label"),o(57,"About"),i()(),t(58,"ion-item")(59,"ion-label"),o(60,"Version"),i(),t(61,"ion-note",3),o(62,"1.0.0"),i()()()()()}if(a&2){let r=D(9);u(7),h("ngIf",e.loading)("ngIfElse",r),u(12),h("value",e.sportsClubId),u(10),y("ngModel",e.darkMode),u(4),y("ngModel",e.language),u(10),h("ngIf",e.userPicture),u(3),w(e.userName),u(2),w(e.userEmail)}},dependencies:[B,L,j,N,W,H,$,F,Q,Z,O,te,G,K,q,z,R,J,ie,X,oe,ne,Y,U],encapsulation:2});let s=l;return s})();export{Pe as SettingsPage};
