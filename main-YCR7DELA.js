import{a as It,c as Ct}from"./chunk-UQZAST5U.js";import{a as St,b as _t,c as F,d as bt,e as m}from"./chunk-SQ4AFRWT.js";import{a as wt}from"./chunk-6WPVMACQ.js";import{C as $,D as ht,F as vt,G as k,K as xt,X as yt,a as ct,b as pt,c as lt,ca as jt,d as mt,e as ut,q as ft,r as dt,s as gt}from"./chunk-QUCUL4SD.js";import{$ as X,A as J,Ba as M,Ca as P,Ea as tt,Ha as T,I as K,Ia as et,J as f,Ja as it,K as l,Ka as ot,La as rt,M as _,Ma as R,N as Q,Na as C,Oa as nt,Pa as st,Q as v,Qa as at,T as d,V as c,W as g,X as I,Xb as E,aa as b,ba as x,e as B,g as z,ja as y,ka as L,l as V,n as U,qa as Y,r as h,ra as j,s as q,sa as w,ta as Z,u as n,x as W,z as G,za as A}from"./chunk-ZFR4GTBG.js";import"./chunk-AW5PRJD7.js";import"./chunk-T47TWMLD.js";import"./chunk-X2LLLM27.js";import"./chunk-GDTBDVVA.js";import"./chunk-EYVCEYVV.js";import"./chunk-YKMIF4NY.js";import"./chunk-YVBCZ55L.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-O4PCMGUI.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{h as O,i as p}from"./chunk-OYAVQN5W.js";var At=(()=>{let t=class t{http;prefix;suffix;constructor(o,i="/assets/i18n/",r=".json"){this.http=o,this.prefix=i,this.suffix=r}getTranslation(o){return this.http.get(`${this.prefix}${o}${this.suffix}`)}};O(t,"\u0275fac",function(i){return new(i||t)(n(T),n(String),n(String))}),O(t,"\u0275prov",h({token:t,factory:t.\u0275fac}));let e=t;return e})();var H=(()=>{let t=class t{constructor(o,i){this.authService=o,this.router=i}canActivate(){return this.authService.isAuthenticated$.pipe(U(1),z(o=>o?!0:(this.router.navigate(["/login"]),!1)))}};t.\u0275fac=function(i){return new(i||t)(n(m),n(C))},t.\u0275prov=h({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var Pt=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",loadComponent:()=>import("./chunk-UMNCN55S.js").then(e=>e.LoginPage)},{path:"settings",canActivate:[H],loadComponent:()=>import("./chunk-IEOI6KZP.js").then(e=>e.SettingsPage)},{path:"tabs",canActivate:[H],loadChildren:()=>import("./chunk-PRFKPGTF.js").then(e=>e.routes)}];var Rt=(()=>{let t=class t{constructor(o,i,r){this.toastController=o,this.router=i,this.authService=r}intercept(o,i){return i.handle(o).pipe(V(r=>{var u,N;let a="An error occurred";return r.error instanceof ErrorEvent?a=`Error: ${r.error.message}`:r.status===401?(this.authService.logout(),this.router.navigate(["/login"]),a="Session expired. Please log in again."):(N=(u=r.error)==null?void 0:u.error)!=null&&N.message?a=r.error.error.message:a=`Error Code: ${r.status}
Message: ${r.message}`,this.presentErrorToast(a),B(()=>r)}))}presentErrorToast(o){return p(this,null,function*(){yield(yield this.toastController.create({message:o,duration:3e3,position:"bottom",color:"danger",buttons:[{text:"Dismiss",role:"cancel"}]})).present()})}};t.\u0275fac=function(i){return new(i||t)(n(vt),n(C),n(m))},t.\u0275prov=h({token:t,factory:t.\u0275fac});let e=t;return e})();function Ot(e,t){if(e&1&&(c(0,"ion-item")(1,"ion-label")(2,"h2"),y(3),g(),c(4,"p"),y(5),g()()()),e&2){let s=t.ngIf;f(3),L(s.name),f(2),L(s.email)}}var Et=(()=>{let t=class t{constructor(o,i){this.authService=o,this.popoverController=i,this.userSession$=this.authService.userSession$}logout(){this.popoverController.dismiss(null,"logout")}};t.\u0275fac=function(i){return new(i||t)(l(m),l($))},t.\u0275cmp=_({type:t,selectors:[["app-profile-menu"]],decls:7,vars:3,consts:[[4,"ngIf"],["button","",3,"click"],["slot","start","name","log-out-outline"]],template:function(i,r){i&1&&(c(0,"ion-list"),v(1,Ot,6,2,"ion-item",0),j(2,"async"),c(3,"ion-item",1),b("click",function(){return r.logout()}),I(4,"ion-icon",2),c(5,"ion-label"),y(6,"Logout"),g()()()),i&2&&(f(),d("ngIf",w(2,1,r.userSession$)))},dependencies:[P,A,M,gt,ft,dt,k],styles:["ion-list[_ngcontent-%COMP%]{margin:0;padding:0}h2[_ngcontent-%COMP%]{font-weight:500;margin:0}p[_ngcontent-%COMP%]{margin:4px 0 0;color:var(--ion-color-medium)}"]});let e=t;return e})();function Lt(e,t){if(e&1&&I(0,"img",7),e&2){let s=x().ngIf;d("src",s.picture,K)}}function Dt(e,t){e&1&&I(0,"ion-icon",8)}function Ht(e,t){if(e&1){let s=X();c(0,"ion-buttons",2)(1,"ion-button",3),b("click",function(i){G(s);let r=x(2);return J(r.showProfileMenu(i))}),c(2,"ion-avatar",4),v(3,Lt,1,1,"img",5)(4,Dt,1,0,"ion-icon",6),g()()()}if(e&2){let s=t.ngIf;f(3),d("ngIf",s.picture),f(),d("ngIf",!s.picture)}}function Nt(e,t){if(e&1&&(v(0,Ht,5,2,"ion-buttons",1),j(1,"async")),e&2){let s=x();d("ngIf",w(1,1,s.userSession$))}}var $t=(()=>{let t=class t{constructor(o,i,r,a,u){this.authService=o,this.router=i,this.popoverController=r,this.route=a,this.clubContext=u,xt({personCircleOutline:jt,logOutOutline:yt}),this.userSession$=this.authService.userSession$}ngOnInit(){return p(this,null,function*(){try{yield _t.initialize({google:{webClientId:St.googleSignInClientId}})}catch(o){console.error("Failed to initialize Social Login:",o)}this.authService.isAuthenticated$.subscribe(o=>p(this,null,function*(){if(o){let i=this.router.url;this.route.queryParams.subscribe(r=>p(this,null,function*(){let a=r.sportsClubId;a&&this.clubContext.setSportsClubId(a);let u=this.clubContext.getSportsClubId();!u&&!i.includes("/settings")?yield this.router.navigate(["/settings"]):u&&!i.includes("/tabs")&&!i.includes("/settings")&&(yield this.router.navigate(["/tabs"]))}))}}))})}showProfileMenu(o){return p(this,null,function*(){let i=yield this.popoverController.create({component:Et,event:o,translucent:!0});yield i.present();let{role:r}=yield i.onWillDismiss();r==="logout"&&(yield this.authService.logout(),yield this.router.navigate(["/login"]))})}};t.\u0275fac=function(i){return new(i||t)(l(m),l(C),l($),l(rt),l(wt))},t.\u0275cmp=_({type:t,selectors:[["app-root"]],features:[Y([{provide:R,useClass:E},{provide:et,useClass:Rt,multi:!0}])],decls:4,vars:0,consts:[["userProfile",""],["slot","end",4,"ngIf"],["slot","end"],[3,"click"],["slot","icon-only"],[3,"src",4,"ngIf"],["name","person-circle-outline",4,"ngIf"],[3,"src"],["name","person-circle-outline"]],template:function(i,r){i&1&&(c(0,"ion-app"),I(1,"ion-router-outlet"),g(),v(2,Nt,2,3,"ng-template",null,0,Z))},dependencies:[P,A,M,pt,ct,lt,k,mt,ut,ot],encapsulation:2});let e=t;return e})();var kt=(()=>{let t=class t{constructor(o){this.storage=o,this.init()}init(){return p(this,null,function*(){yield this.storage.create()})}};t.\u0275fac=function(i){return new(i||t)(n(F))},t.\u0275mod=Q({type:t}),t.\u0275inj=q({providers:[F],imports:[bt.forRoot({name:"playmate_db",driverOrder:["indexeddb","localstorage"]})]});let e=t;return e})();function Bt(e){return new At(e,"./assets/i18n/",".json")}tt($t,{providers:[{provide:R,useClass:E},ht(),st(Pt,at(nt)),it(),W(kt,Ct.forRoot({loader:{provide:It,useFactory:Bt,deps:[T]},defaultLanguage:"en"}))]});export{Bt as createTranslateLoader};
